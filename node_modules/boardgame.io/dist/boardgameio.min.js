!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e=e||self).BoardgameIO={},e.React)}(this,function(e,t){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(n,!0).forEach(function(t){a(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function d(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}t=t&&t.hasOwnProperty("default")?t.default:t;var y=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),v=function(){return Math.random().toString(36).substring(7).split("").join(".")},m={INIT:"@@redux/INIT"+v(),REPLACE:"@@redux/REPLACE"+v(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+v()}};function g(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(g)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var o=e,i=t,a=[],s=a,c=!1;function l(){s===a&&(s=a.slice())}function u(){if(c)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return i}function p(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(c)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return l(),s.push(e),function(){if(t){if(c)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,l();var n=s.indexOf(e);s.splice(n,1)}}}function f(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(c)throw new Error("Reducers may not dispatch actions.");try{c=!0,i=o(i,e)}finally{c=!1}for(var t=a=s,n=0;n<t.length;n++){(0,t[n])()}return e}return f({type:m.INIT}),(r={dispatch:f,subscribe:p,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");o=e,f({type:m.REPLACE})}})[y]=function(){var e,t=p;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[y]=function(){return this},e},r}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n}function w(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function k(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},i=t.map(function(e){return e(o)});return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(n,!0).forEach(function(t){b(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n,{dispatch:r=w.apply(void 0,i)(n.dispatch)})}}}var $,P,C,O="MAKE_MOVE",I="GAME_EVENT",D="REDO",A="RESET",_="SYNC",E="UNDO",S="UPDATE",j=function(e,t,n,r){return{type:O,payload:{type:e,args:t,playerID:n,credentials:r}}},B=function(e,t,n,r){return{type:I,payload:{type:e,args:t,playerID:n,credentials:r}}},N=function(e,t,n,r){return{type:I,payload:{type:e,args:t,playerID:n,credentials:r},automatic:!0}},M=function(e,t){return{type:_,state:e,log:t,clientOnly:!0}},T=function(e,t){return{type:S,state:e,deltalog:t,clientOnly:!0}},R=function(e){return{type:A,state:e,clientOnly:!0}},q=function(){return{type:E}},L=function(){return{type:D}},z=Object.freeze({makeMove:j,gameEvent:B,automaticGameEvent:N,sync:M,update:T,reset:R,undo:q,redo:L}),F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},U=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},G=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),H="undefined"!=typeof Symbol?Symbol("immer-nothing"):(C=!0,(P="immer-nothing")in($={})?Object.defineProperty($,P,{value:C,enumerable:!0,configurable:!0,writable:!0}):$[P]=C,$),K="undefined"!=typeof Symbol?Symbol("immer-draftable"):"__$immer_draftable",V="undefined"!=typeof Symbol?Symbol("immer-state"):"__$immer_state";function W(e){return!!e&&!!e[V]}function J(e){if(!e||"object"!==(void 0===e?"undefined":F(e)))return!1;if(Array.isArray(e))return!0;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype||(!!e[K]||!!e.constructor[K])}var X=Object.assign||function(e,t){for(var n in t)te(t,n)&&(e[n]=t[n]);return e},Y="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function Q(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(e))return e.slice();var n=Object.create(Object.getPrototypeOf(e));return Y(e).forEach(function(r){if(r!==V){var o=Object.getOwnPropertyDescriptor(e,r);if(o.get){if(!t)throw new Error("Immer drafts cannot have computed properties");o.value=o.get.call(e)}o.enumerable?n[r]=o.value:Object.defineProperty(n,r,{value:o.value,writable:!0,configurable:!0})}}),n}function Z(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(n,e[n],e);else Y(e).forEach(function(n){return t(n,e[n],e)})}function ee(e,t){return Object.getOwnPropertyDescriptor(e,t).enumerable}function te(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ne(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var re={},oe=[],ie=function(){return oe[oe.length-1]};function ae(e,t){var n=Array.isArray(e),r=pe(e);Z(r,function(t){!function(e,t,n){var r=re[t];r?r.enumerable=n:re[t]=r={configurable:!0,enumerable:n,get:function(){return function(e,t){fe(e);var n=ce(e)[t];if(!e.finalizing&&n===e.base[t]&&J(n))return ue(e),e.copy[t]=ae(n,e);return n}(this[V],t)},set:function(e){!function(e,t,n){if(fe(e),e.assigned[t]=!0,!e.modified){if(ne(ce(e)[t],n))return;le(e),ue(e)}e.copy[t]=n}(this[V],t,e)}};Object.defineProperty(e,t,r)}(r,t,n||ee(e,t))});var o,i,a,s={scope:t?t.scope:ie(),modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:t,base:e,draft:r,copy:null,revoke:se,revoked:!1};return o=r,i=V,a=s,Object.defineProperty(o,i,{value:a,enumerable:!1,writable:!0}),s.scope.push(s),r}function se(){this.revoked=!0}function ce(e){return e.copy||e.base}function le(e){e.modified||(e.modified=!0,e.parent&&le(e.parent))}function ue(e){e.copy||(e.copy=pe(e.base))}function pe(e){var t=e&&e[V];if(t){t.finalizing=!0;var n=Q(t.draft,!0);return t.finalizing=!1,n}return Q(e)}function fe(e){if(!0===e.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(ce(e)))}function de(e){for(var t=e.base,n=e.draft,r=Object.keys(n),o=r.length-1;o>=0;o--)if(void 0===t[r[o]]&&!te(t,r[o]))return!0;return r.length!==Object.keys(t).length}function he(e){var t=e.draft;if(t.length!==e.base.length)return!0;var n=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!n||n.get)}var ye=Object.freeze({scopes:oe,currentScope:ie,willFinalize:function(e,t,n){var r=ie();r.forEach(function(e){return e.finalizing=!0}),void 0!==e&&e!==t||(n&&function e(t){if(t&&"object"===(void 0===t?"undefined":F(t))){var n=t[V];if(n){var r=n.base,o=n.draft,i=n.assigned;if(Array.isArray(t)){if(he(n)){if(le(n),i.length=!0,o.length<r.length)for(var a=o.length;a<r.length;a++)i[a]=!1;else for(var s=r.length;s<o.length;s++)i[s]=!0;for(var c=0;c<o.length;c++)void 0===i[c]&&e(o[c])}}else Object.keys(o).forEach(function(t){void 0!==r[t]||te(r,t)?i[t]||e(o[t]):(i[t]=!0,le(n))}),Object.keys(r).forEach(function(e){void 0!==o[e]||te(o,e)||(i[e]=!1,le(n))})}}}(t),function(e){for(var t=e.length-1;t>=0;t--){var n=e[t];!1===n.modified&&(Array.isArray(n.base)?he(n)&&le(n):de(n)&&le(n))}}(r))},createDraft:ae}),ve=[],me=function(){return ve[ve.length-1]};function ge(e,t){var n={scope:t?t.scope:me(),modified:!1,finalized:!1,assigned:{},parent:t,base:e,draft:null,drafts:{},copy:null,revoke:null},r=Array.isArray(e)?Proxy.revocable([n],xe):Proxy.revocable(n,be),o=r.revoke,i=r.proxy;return n.draft=i,n.revoke=o,n.scope.push(n),i}var be={get:function(e,t){if(t===V)return e;var n=e.drafts;if(!e.modified&&te(n,t))return n[t];var r=we(e)[t];if(e.finalized||!J(r))return r;if(e.modified){if(r!==e.base[t])return r;n=e.copy}return n[t]=ge(r,e)},has:function(e,t){return t in we(e)},ownKeys:function(e){return Reflect.ownKeys(we(e))},set:function(e,t,n){if(!e.modified){var r=n?ne(e.base[t],n)||n===e.drafts[t]:ne(e.base[t],n)&&t in e.base;if(r)return!0;ke(e)}return e.assigned[t]=!0,e.copy[t]=n,!0},deleteProperty:function(e,t){(void 0!==e.base[t]||t in e.base)&&(e.assigned[t]=!1,ke(e));e.copy&&delete e.copy[t];return!0},getOwnPropertyDescriptor:function(e,t){var n=we(e),r=Reflect.getOwnPropertyDescriptor(n,t);r&&(r.writable=!0,r.configurable=!Array.isArray(n)||"length"!==t);return r},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(e){return Object.getPrototypeOf(e.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},xe={};function we(e){return e.copy||e.base}function ke(e){e.modified||(e.modified=!0,e.copy=X(Q(e.base),e.drafts),e.drafts=null,e.parent&&ke(e.parent))}Z(be,function(e,t){xe[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),xe.deleteProperty=function(e,t){if(isNaN(parseInt(t)))throw new Error("Immer only supports deleting array indices");return be.deleteProperty.call(this,e[0],t)},xe.set=function(e,t,n){if("length"!==t&&isNaN(parseInt(t)))throw new Error("Immer only supports setting array indices and the 'length' property");return be.set.call(this,e[0],t,n)};var $e=Object.freeze({scopes:ve,currentScope:me,willFinalize:function(){},createDraft:ge});function Pe(e,t,n,r){Array.isArray(e.base)?function(e,t,n,r){for(var o=e.base,i=e.copy,a=e.assigned,s=Math.min(o.length,i.length),c=0;c<s;c++)if(a[c]&&o[c]!==i[c]){var l=t.concat(c);n.push({op:"replace",path:l,value:i[c]}),r.push({op:"replace",path:l,value:o[c]})}if(s<i.length){for(var u=s;u<i.length;u++)n.push({op:"add",path:t.concat(u),value:i[u]});r.push({op:"replace",path:t.concat("length"),value:o.length})}else if(s<o.length){n.push({op:"replace",path:t.concat("length"),value:i.length});for(var p=s;p<o.length;p++)r.push({op:"add",path:t.concat(p),value:o[p]})}}(e,t,n,r):function(e,t,n,r){var o=e.base,i=e.copy;Z(e.assigned,function(e,a){var s=o[e],c=i[e],l=a?e in o?"replace":"add":"remove";if(s!==c||"replace"!==l){var u=t.concat(e);n.push("remove"===l?{op:l,path:u}:{op:l,path:u,value:c}),r.push("add"===l?{op:"remove",path:u}:"remove"===l?{op:"add",path:u,value:s}:{op:"replace",path:u,value:s})}})}(e,t,n,r)}function Ce(e,t){for(var n=0;n<t.length;n++){var r=t[n],o=r.path;if(0===o.length&&"replace"===r.op)e=r.value;else{for(var i=e,a=0;a<o.length-1;a++)if(!(i=i[o[a]])||"object"!==(void 0===i?"undefined":F(i)))throw new Error("Cannot apply patch, path doesn't resolve: "+o.join("/"));var s=o[o.length-1];switch(r.op){case"replace":case"add":i[s]=r.value;break;case"remove":if(Array.isArray(i)){if(s!==i.length-1)throw new Error("Only the last index of an array can be removed, index: "+s+", length: "+i.length);i.length-=1}else delete i[s];break;default:throw new Error("Unsupported patch operation: "+r.op)}}}return e}var Oe={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:"undefined"==typeof process&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},Ie=new(function(){function e(t){U(this,e),X(this,Oe,t),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)}return G(e,[{key:"produce",value:function(e,t,n){var r=this;if("function"==typeof e&&"function"!=typeof t){var o=t;return t=e,function(){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return r.produce(a,function(e){var r;return(r=t).call.apply(r,[e,e].concat(n))})}}if("function"!=typeof t)throw new Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==n&&"function"!=typeof n)throw new Error("the third argument of a producer should not be set or a function");var i=void 0;if(J(e)){this.scopes.push([]);var a=this.createDraft(e);try{i=t.call(a,a),this.willFinalize(i,a,!!n);var s=n&&[],c=n&&[];if(void 0===i||i===a)i=this.finalize(a,[],s,c);else{if(a[V].modified)throw new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");J(i)&&(i=this.finalize(i)),n&&(s.push({op:"replace",path:[],value:i}),c.push({op:"replace",path:[],value:e}))}}finally{this.currentScope().forEach(function(e){return e.revoke()}),this.scopes.pop()}n&&n(s,c)}else if(void 0===(i=t(e)))return e;return i===H?void 0:i}},{key:"setAutoFreeze",value:function(e){this.autoFreeze=e}},{key:"setUseProxies",value:function(e){this.useProxies=e,X(this,e?$e:ye)}},{key:"applyPatches",value:function(e,t){return W(e)?Ce(e,t):this.produce(e,function(e){return Ce(e,t)})}},{key:"finalize",value:function(e,t,n,r){var o=this,i=e[V];if(!i)return Object.isFrozen(e)?e:this.finalizeTree(e);if(i.scope!==this.currentScope())return e;if(!i.modified)return i.base;if(!i.finalized){if(i.finalized=!0,this.finalizeTree(i.draft,t,n,r),this.onDelete)if(this.useProxies){var a=i.assigned;for(var s in a)a[s]||this.onDelete(i,s)}else{var c=i.base,l=i.copy;Z(c,function(e){te(l,e)||o.onDelete(i,e)})}this.onCopy&&this.onCopy(i),this.autoFreeze&&1===this.scopes.length&&Object.freeze(i.copy),n&&Pe(i,t,n,r)}return i.copy}},{key:"finalizeTree",value:function(e,t,n,r){var o=this,i=e[V];i&&(this.useProxies||(i.finalizing=!0,i.copy=Q(i.draft,!0),i.finalizing=!1),e=i.copy);var a=this.onAssign;return Z(e,function s(c,l,u){if(l===u)throw Error("Immer forbids circular references");var p=!!i&&u===e;if(W(l)){if(l=n&&p&&!i.assigned[c]?o.finalize(l,t.concat(c),n,r):o.finalize(l),Array.isArray(u)||ee(u,c)?u[c]=l:Object.defineProperty(u,c,{value:l}),p&&l===i.base[c])return}else{if(p&&ne(l,i.base[c]))return;J(l)&&!Object.isFrozen(l)&&Z(l,s)}p&&a&&a(i,c,l)}),e}}]),e}()),De=Ie.produce,Ae=(Ie.setAutoFreeze.bind(Ie),Ie.setUseProxies.bind(Ie),Ie.applyPatches.bind(Ie),[{fnWrap:function(e){return De(e)}}]),_e={G:function(e,t,n){return[].concat(Ae,h(n.plugins)).filter(function(e){return void 0!==e.setup}).filter(function(e){return void 0!==e.setup.G}).forEach(function(r){e=r.setup.G(e,t,n)}),e},ctx:function(e,t){return[].concat(Ae,h(t.plugins)).filter(function(e){return void 0!==e.setup}).filter(function(e){return void 0!==e.setup.ctx}).forEach(function(n){e=n.setup.ctx(e,t)}),e}},Ee=function(e,t){return[].concat(Ae,h(t)).filter(function(e){return void 0!==e.fnWrap}).reduce(function(e,n){return(0,n.fnWrap)(e,t)},e)},Se=function(e,t){return[].concat(Ae,h(t)).filter(function(e){return void 0!==e.beforeMove}).forEach(function(t){e=t.beforeMove(e)}),e},je=function(e,t){return[].concat(Ae,h(t)).filter(function(e){return void 0!==e.beforeEvent}).forEach(function(t){e=t.beforeEvent(e)}),e},Be=function(e,t){return[].concat(Ae,h(t)).filter(function(e){return void 0!==e.afterMove}).forEach(function(t){e=t.afterMove(e)}),e},Ne=function(e,t){return[].concat(Ae,h(t)).filter(function(e){return void 0!==e.afterEvent}).forEach(function(t){e=t.afterEvent(e)}),e},Me=console.log,Te=console.error;function Re(e){Te("ERROR:",e)}function qe(e,t,n){return c({},e,{ctx:Le(e.ctx,n)})}function Le(e,t){var n=e._prevActivePlayers,r=t.next||null;n=t.revert?n.concat({activePlayers:e.activePlayers,_activePlayersMoveLimit:e._activePlayersMoveLimit,_activePlayersNumMoves:e._activePlayersNumMoves}):[];var o={},i={};if(Array.isArray(t)){var a={};t.forEach(function(e){return a[e]=Ge.NULL}),o=a}if(void 0!==t.currentPlayer&&ze(o,i,e.currentPlayer,t.currentPlayer),void 0!==t.others)for(var s=0;s<e.playOrder.length;s++){var l=e.playOrder[s];l!==e.currentPlayer&&ze(o,i,l,t.others)}if(void 0!==t.all)for(var u=0;u<e.playOrder.length;u++){ze(o,i,e.playOrder[u],t.all)}if(t.value)for(var p in t.value)ze(o,i,p,t.value[p]);if(t.moveLimit)for(var f in o)void 0===i[f]&&(i[f]=t.moveLimit);0==Object.keys(o).length&&(o=null),0==Object.keys(i).length&&(i=null);var d={};for(var h in o)d[h]=0;return c({},e,{activePlayers:o,_activePlayersMoveLimit:i,_activePlayersNumMoves:d,_prevActivePlayers:n,_nextActivePlayers:r})}function ze(e,t,r,o){"object"===n(o)&&o!==Ge.NULL||(o={stage:o}),void 0!==o.stage&&(e[r]=o.stage,o.moveLimit&&(t[r]=o.moveLimit))}function Fe(e,t){return e[t]+""}var Ue={DEFAULT:{first:function(e,t){return 0===t.turn?t.playOrderPos:(t.playOrderPos+1)%t.playOrder.length},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}},RESET:{first:function(){return 0},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}},CONTINUE:{first:function(e,t){return t.playOrderPos},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}},ONCE:{first:function(){return 0},next:function(e,t){if(t.playOrderPos<t.playOrder.length-1)return t.playOrderPos+1}},CUSTOM:function(e){return{playOrder:function(){return e},first:function(){return 0},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}}},CUSTOM_FROM:function(e){return{playOrder:function(t){return t[e]},first:function(){return 0},next:function(e,t){return(t.playOrderPos+1)%t.playOrder.length}}},SKIP:{first:function(e,t){return t.playOrderPos},next:function(e,t){if(!e.allPassed)for(var n=t.playOrderPos,r=0;r<t.playOrder.length;r++)if(n=(n+1)%t.playOrder.length,!e.passOrder.includes(t.playOrder[n]+""))return n}}},Ge={NULL:null};function He(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function Ke(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function Ve(e,t){var r=new He(e),o=t&&t.state,i=r.next;return i.quick=i,o&&("object"==n(o)&&Ke(o,r),i.state=function(){return Ke(r,{})}),i}var We=function(){function e(t){r(this,e),this.state=t._random||{seed:"0"}}return i(e,[{key:"update",value:function(e){var t=c({},e.ctx,{_random:this.state});return c({},e,{ctx:t})}},{key:"attach",value:function(e){return c({},e,{random:this._api()})}},{key:"_random",value:function(){var e,t=this.state,n=(e=void 0===t.prngstate?new Ve(t.seed,{state:!0}):new Ve("",{state:t.prngstate}))();return this.state=c({},t,{prngstate:e.state()}),n}},{key:"_api",value:function(){var e=this._random.bind(this),t={D4:4,D6:6,D8:8,D10:10,D12:12,D20:20},n={},r=function(r){var o=t[r];n[r]=function(t){return void 0===t?Math.floor(e()*o)+1:h(new Array(t).keys()).map(function(){return Math.floor(e()*o)+1})}};for(var o in t)r(o);return c({},n,{Die:function(t,n){return void 0===t&&(t=6),void 0===n?Math.floor(e()*t)+1:h(new Array(n).keys()).map(function(){return Math.floor(e()*t)+1})},Number:function(){return e()},Shuffle:function(t){for(var n=t.slice(0),r=t.length,o=0,i=new Array(r);r;){var a=r*e()|0;i[o++]=n[a],n[a]=n[--r]}return i}})}}]),e}();We.detach=function(e){e.random;return f(e,["random"])},We.seed=function(){return(+new Date).toString(36).slice(-10)};var Je=function(){function e(t,n){r(this,e),this.flow=t,this.playerID=n,this.dispatch=[]}return i(e,[{key:"attach",value:function(e){var t=this,n={},r=e.phase,o=e.turn,i=!0,a=!1,s=void 0;try{for(var l,u=function(){var e=l.value;n[e]=function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];t.dispatch.push({key:e,args:i,phase:r,turn:o})}},p=this.flow.eventNames[Symbol.iterator]();!(i=(l=p.next()).done);i=!0)u()}catch(e){a=!0,s=e}finally{try{i||null==p.return||p.return()}finally{if(a)throw s}}return c({},e,{events:n})}},{key:"update",value:function(e){for(var t=0;t<this.dispatch.length;t++){var n=this.dispatch[t];if(("endTurn"!==n.key||n.turn===e.ctx.turn)&&("endPhase"!==n.key&&"setPhase"!==n.key||n.phase===e.ctx.phase)){var r=N(n.key,n.args,this.playerID);e=c({},e,{},this.flow.processEvent(e,r))}}return e}}]),e}();Je.detach=function(e){e.events;return f(e,["events"])};var Xe=function(){function e(){r(this,e),this._payload=void 0}return i(e,[{key:"_api",value:function(){var e=this;return{setPayload:function(t){e._payload=t}}}},{key:"attach",value:function(e){return c({},e,{log:this._api()})}},{key:"update",value:function(e){if(void 0===this._payload)return e;var t=e.deltalog;return t[t.length-1]=c({},t[t.length-1],{payload:this._payload}),this._payload=void 0,c({},e,{deltalog:t})}}],[{key:"detach",value:function(e){e.log;return f(e,["log"])}}]),e}(),Ye=function(){function e(t,n,o){r(this,e),this.random=new We(t),this.events=new Je(n.flow,o),this.log=new Xe}return i(e,[{key:"attachToContext",value:function(e){var t=this.random.attach(e);return t=this.events.attach(t),t=this.log.attach(t)}},{key:"_update",value:function(e,t){var n=t?this.events.update(e):e;return n=this.random.update(n),n=this.log.update(n)}},{key:"updateAndDetach",value:function(t,n){var r=this._update(t,n);return r.ctx=e.detachAllFromContext(r.ctx),r}}],[{key:"detachAllFromContext",value:function(e){var t=We.detach(e);return t=Je.detach(t),t=Xe.detach(t)}}]),e}();function Qe(e){var t=e.moves,r=e.phases,o=e.endIf,i=e.turn,a=e.events,s=e.plugins;void 0===t&&(t={}),void 0===a&&(a={}),void 0===s&&(s=[]),void 0===r&&(r={}),o||(o=function(){}),i||(i={});var l=c({},r);""in l&&Re("cannot specify phase with empty name"),l[""]={};var u={},p=new Set,d=null;for(var y in Object.keys(t).forEach(function(e){return p.add(e)}),l){var v=l[y];if(!0===v.start&&(d=y),void 0!==v.moves)for(var m=0,g=Object.keys(v.moves);m<g.length;m++){var b=g[m];u[y+"."+b]=v.moves[b],p.add(b)}for(var x in void 0===v.endIf&&(v.endIf=function(){}),void 0===v.onBegin&&(v.onBegin=function(e){return e}),void 0===v.onEnd&&(v.onEnd=function(e){return e}),void 0===v.turn&&(v.turn=i),void 0===v.turn.order&&(v.turn.order=Ue.DEFAULT),void 0===v.turn.onBegin&&(v.turn.onBegin=function(e){return e}),void 0===v.turn.onEnd&&(v.turn.onEnd=function(e){return e}),void 0===v.turn.endIf&&(v.turn.endIf=function(){return!1}),void 0===v.turn.onMove&&(v.turn.onMove=function(e){return e}),void 0===v.turn.stages&&(v.turn.stages={}),v.turn.stages)for(var w=v.turn.stages[x].moves||{},k=0,$=Object.keys(w);k<$.length;k++){var P=$[k];u[y+"."+x+"."+P]=w[P],p.add(P)}v.onBegin=Ee(v.onBegin,s),v.onEnd=Ee(v.onEnd,s),v.turn.onMove=Ee(v.turn.onMove,s),v.turn.onBegin=Ee(v.turn.onBegin,s),v.turn.onEnd=Ee(v.turn.onEnd,s)}function C(e){return e.phase?l[e.phase]:l[""]}function O(e){return e}function I(e,t){for(var n=new Set,r=new Set,o=0;o<t.length;o++){var i=t[o],a=i.fn,s=i.arg,l=f(i,["fn","arg"]);if(a===q){r.clear();var u=e.ctx.phase;if(n.has(u)){var p=c({},e.ctx,{phase:null});return c({},e,{ctx:p})}n.add(u)}var d=[];if(e=a(e,c({},l,{arg:s,next:d})),a===R)break;var h=N(e);if(h)t.push({fn:R,arg:h,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});else{var y=M(e);if(y)t.push({fn:q,arg:y,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});else{if(a===O){var v=T(e);if(v){t.push({fn:L,arg:v,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});continue}}t.push.apply(t,d)}}}return e}function D(e,t){return t.next.push({fn:A}),e}function A(e,t){var n=t.next,r=e.G,o=e.ctx;return r=C(o).onBegin(r,o),n.push({fn:_}),c({},e,{G:r,ctx:o})}function _(e,t){var n=t.currentPlayer,r=e.G,o=e.ctx,i=C(o);return n?(o=c({},o,{currentPlayer:n}),i.turn.activePlayers&&(o=Le(o,i.turn.activePlayers))):o=function(e,t,n){var r=n.order,o=h(new Array(t.numPlayers)).map(function(e,t){return t+""});void 0!==r.playOrder&&(o=r.playOrder(e,t));var i=r.first(e,t);return t=Le(t=c({},t,{currentPlayer:Fe(o,i),playOrderPos:i,playOrder:o}),n.activePlayers||{})}(r,o,i.turn),o=c({},o,{turn:o.turn+1,numMoves:0,_prevActivePlayers:[]}),c({},e,{G:r=i.turn.onBegin(r,o),ctx:o,_undo:[{G:r,ctx:Ye.detachAllFromContext(o)}],_redo:[]})}function E(e,t){var n=t.arg,r=t.next,o=C({phase:t.phase}),i=e.ctx;if(n&&n.next){if(!(n.next in l))return Re("invalid phase: "+n.next),e;i=c({},i,{phase:n.next})}else i=void 0!==o.next?c({},i,{phase:o.next}):c({},i,{phase:null});return e=c({},e,{ctx:i}),r.push({fn:A}),e}function S(e,t){var r=t.arg,o=t.currentPlayer,i=t.next,a=e,s=a.G,l=a.ctx,u=C(l),p=function(e,t,r,o){var i=r.order,a=t.playOrderPos,s=t.currentPlayer,l=!1;if(o&&!0!==o)"object"!==n(o)&&Re("invalid argument to endTurn: ".concat(o)),Object.keys(o).forEach(function(e){switch(e){case"remove":s=Fe(t.playOrder,a);break;case"next":a=t.playOrder.indexOf(o.next),s=o.next;break;default:Re("invalid argument to endTurn: ".concat(e))}});else{var u=i.next(e,t);void 0===u?l=!0:(a=u,s=Fe(t.playOrder,a))}return{endPhase:l,ctx:t=c({},t,{playOrderPos:a,currentPlayer:s})}}(s,c({},l,{currentPlayer:o}),u.turn,r),f=p.endPhase;return e=c({},e,{G:s,ctx:l=p.ctx}),f?i.push({fn:q,turn:l.turn,phase:l.phase}):i.push({fn:_,currentPlayer:l.currentPlayer}),e}function j(e,t){var n=t.arg,r=t.playerID;"string"==typeof n&&(n={stage:n});var o=e.ctx,i=o,a=i.activePlayers,s=i._activePlayersMoveLimit,l=i._activePlayersNumMoves;return n.stage&&(null===a&&(a={}),a[r]=n.stage,l[r]=0,n.moveLimit&&(null===s&&(s={}),s[r]=n.moveLimit)),o=c({},o,{activePlayers:a,_activePlayersMoveLimit:s,_activePlayersNumMoves:l}),c({},e,{ctx:o})}function N(e){var t=e.G,n=e.ctx;return o(t,n)}function M(e){var t=e.G,n=e.ctx;return C(n).endIf(t,n)}function T(e){var t=e.G,n=e.ctx,r=C(n),o=n.numMoves||0;return!!(r.turn.moveLimit&&o>=r.turn.moveLimit)||r.turn.endIf(t,n)}function R(e,t){var n=t.arg;return void 0===n&&(n=!0),c({},e=q(e,{phase:t.phase}),{ctx:c({},e.ctx,{gameover:n})})}function q(e,t){var n=t.arg,r=t.next,o=t.turn,i=t.automatic,a=(e=L(e,{turn:o,force:!0})).G,s=e.ctx;if(r&&r.push({fn:E,arg:n,phase:s.phase}),null===s.phase)return e;a=C(s).onEnd(a,s),s=c({},s,{phase:null});var l={action:B("endPhase",n),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};return i&&(l.automatic=!0),c({},e,{G:a,ctx:s,deltalog:[].concat(h(e.deltalog),[l])})}function L(e,t){var n=t.arg,r=t.next,o=t.turn,i=t.force,a=t.automatic,s=t.playerID;if(o!==e.ctx.turn)return e;var l,u=e.G,p=e.ctx,f=C(p),d=p.numMoves||0;if(!i&&f.turn.moveLimit&&d<f.turn.moveLimit)return l="cannot end turn before making ".concat(f.turn.moveLimit," moves"),Me("INFO: ".concat(l)),e;if(u=f.turn.onEnd(u,p),r&&r.push({fn:S,arg:n,currentPlayer:p.currentPlayer}),p=c({},p,{activePlayers:null}),n&&n.remove){s=s||p.currentPlayer;var y=p.playOrder.filter(function(e){return e!=s});if(p=c({},p,{playOrder:y,playOrderPos:p.playOrderPos>y.length-1?0:p.playOrderPos}),0===y.length)return r.push({fn:q,turn:p.turn,phase:p.phase}),e}var v={action:B("endTurn",n),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};return a&&(v.automatic=!0),c({},e,{G:u,ctx:p,deltalog:[].concat(h(e.deltalog||[]),[v]),_undo:[],_redo:[]})}function z(e,t){var n=t.arg,r=t.next,o=t.automatic,i=t.playerID;i=i||e.ctx.currentPlayer;var a=e.ctx,s=a,l=s.activePlayers,u=s._activePlayersMoveLimit,p=null!==l&&i in l;if(!n&&p){var f=C(a).turn.stages[l[i]];f&&f.next&&(n=f.next)}if(r&&n&&r.push({fn:j,arg:n,playerID:i}),!p)return e;l=Object.keys(l).filter(function(e){return e!==i}).reduce(function(e,t){return e[t]=l[t],e},{}),u&&(u=Object.keys(u).filter(function(e){return e!==i}).reduce(function(e,t){return e[t]=u[t],e},{})),a=function(e){var t=e,n=t.activePlayers,r=t._activePlayersMoveLimit,o=t._activePlayersNumMoves,i=t._prevActivePlayers;if(n&&0==Object.keys(n).length)if(e._nextActivePlayers){var a=e=Le(e,e._nextActivePlayers);n=a.activePlayers,r=a._activePlayersMoveLimit,o=a._activePlayersNumMoves,i=a._prevActivePlayers}else if(i.length>0){var s=i.length-1,l=i[s];n=l.activePlayers,r=l._activePlayersMoveLimit,o=l._activePlayersNumMoves,i=i.slice(0,s)}else n=null,r=null;return c({},e,{activePlayers:n,_activePlayersMoveLimit:r,_activePlayersNumMoves:o,_prevActivePlayers:i})}(c({},a,{activePlayers:l,_activePlayersMoveLimit:u}));var d={action:B("endStage",n),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};return o&&(d.automatic=!0),c({},e,{ctx:a,deltalog:[].concat(h(e.deltalog||[]),[d])})}var F={endStage:function(e,t){return I(e,[{fn:z,playerID:t}])},setStage:function(e,t,n){return I(e,[{fn:z,arg:n,playerID:t}])},endTurn:function(e,t,n){return I(e,[{fn:L,turn:e.ctx.turn,phase:e.ctx.phase,arg:n}])},pass:function(e,t,n){return I(e,[{fn:L,turn:e.ctx.turn,phase:e.ctx.phase,force:!0,arg:n}])},endPhase:function(e){return I(e,[{fn:q,phase:e.ctx.phase,turn:e.ctx.turn}])},setPhase:function(e,t,n){return I(e,[{fn:q,phase:e.ctx.phase,turn:e.ctx.turn,arg:{next:n}}])},endGame:function(e,t,n){return I(e,[{fn:R,turn:e.ctx.turn,phase:e.ctx.phase,arg:n}])},setActivePlayers:qe},U=[];return!1!==a.endTurn&&U.push("endTurn"),!1!==a.pass&&U.push("pass"),!1!==a.endPhase&&U.push("endPhase"),!1!==a.setPhase&&U.push("setPhase"),!1!==a.endGame&&U.push("endGame"),!1!==a.setActivePlayers&&U.push("setActivePlayers"),!1!==a.endStage&&U.push("endStage"),!1!==a.setStage&&U.push("setStage"),{ctx:function(e){return{numPlayers:e,turn:0,currentPlayer:"0",playOrder:h(new Array(e)).map(function(e,t){return t+""}),playOrderPos:0,phase:d,activePlayers:null}},init:function(e){return I(e,[{fn:D}])},isPlayerActive:function(e,t,n){return t.activePlayers?n in t.activePlayers:t.currentPlayer===n},eventHandlers:F,eventNames:Object.keys(F),enabledEventNames:U,moveMap:u,moveNames:h(p.values()),processMove:function(e,t){var n=C(e.ctx),r=e.ctx,o=r._activePlayersNumMoves,i=t.playerID;r.activePlayers&&o[i]++;var a=e.ctx.numMoves;i==e.ctx.currentPlayer&&a++,e=c({},e,{ctx:c({},r,{numMoves:a,_activePlayersNumMoves:o})}),r._activePlayersMoveLimit&&o[i]>=r._activePlayersMoveLimit[i]&&(e=z(e,{playerID:i,automatic:!0}));var s=(e=c({},e,{G:n.turn.onMove(e.G,e.ctx,t)}))._undo||[],l=t.type,u=Ye.detachAllFromContext(e.ctx);return I(e=c({},e,{_undo:[].concat(h(s),[{G:e.G,ctx:u,moveType:l}]),_redo:[]}),[{fn:O}])},processEvent:function(e,t){var n=t.payload,r=n.type,o=n.playerID,i=n.args;if(F.hasOwnProperty(r)){var a=[e,o].concat(i);return F[r].apply({},a)}return e},getMove:function(e,n,r){var o=C(e),i=o.turn.stages,a=e.activePlayers;if(a&&void 0!==a[r]&&a[r]!==Ge.NULL&&void 0!==i[a[r]]&&void 0!==i[a[r]].moves){var s=i[a[r]].moves;if(n in s)return s[n]}else if(o.moves){if(n in o.moves)return o.moves[n]}else if(n in t)return t[n];return null}}}function Ze(e){if(e.processMove)return e;if(void 0===e.name&&(e.name="default"),void 0===e.setup&&(e.setup=function(){return{}}),void 0===e.moves&&(e.moves={}),void 0===e.playerView&&(e.playerView=function(e){return e}),void 0===e.plugins&&(e.plugins=[]),e.name.includes(" "))throw new Error(e.name+": Game name must not include spaces");var t=Qe(e);return c({},e,{flow:t,moveNames:t.moveNames,processMove:function(n,r,o){var i=t.getMove(o,r.type,r.playerID);if(i instanceof Object&&i.move&&(i=i.move),i instanceof Function){var a=[n,c({},o,{playerID:r.playerID})].concat(r.args);return Ee(i,e.plugins).apply(void 0,h(a))}return n}})}function et(){}const tt=e=>e;function nt(e,t){for(const n in t)e[n]=t[n];return e}function rt(e){return e()}function ot(){return Object.create(null)}function it(e){e.forEach(rt)}function at(e){return"function"==typeof e}function st(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function ct(e,t,n){e.$$.on_destroy.push(function(e,t){const n=e.subscribe(t);return n.unsubscribe?()=>n.unsubscribe():n}(t,n))}function lt(e,t,n){return e[1]?nt({},nt(t.$$scope.ctx,e[1](n?n(t):{}))):t.$$scope.ctx}function ut(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}const pt="undefined"!=typeof window;let ft=pt?()=>window.performance.now():()=>Date.now(),dt=pt?e=>requestAnimationFrame(e):et;const ht=new Set;let yt,vt=!1;function mt(){ht.forEach(e=>{e[0](ft())||(ht.delete(e),e[1]())}),(vt=ht.size>0)&&dt(mt)}function gt(e,t){e.appendChild(t)}function bt(e,t,n){e.insertBefore(t,n||null)}function xt(e){e.parentNode.removeChild(e)}function wt(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function kt(e){return document.createElement(e)}function $t(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Pt(e){return document.createTextNode(e)}function Ct(){return Pt(" ")}function Ot(){return Pt("")}function It(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function Dt(e,t,n){null==n?e.removeAttribute(t):e.setAttribute(t,n)}function At(e,t){t=""+t,e.data!==t&&(e.data=t)}function _t(e,t){(null!=t||e.value)&&(e.value=t)}function Et(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}}function St(e,t,n){e.classList[n?"add":"remove"](t)}function jt(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}let Bt,Nt=0,Mt={};function Tt(e,t,n,r,o,i,a,s=0){const c=16.666/r;let l="{\n";for(let e=0;e<=1;e+=c){const r=t+(n-t)*i(e);l+=100*e+`%{${a(r,1-r)}}\n`}const u=l+`100% {${a(n,1-n)}}\n}`,p=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${s}`;if(!Mt[p]){if(!yt){const e=kt("style");document.head.appendChild(e),yt=e.sheet}Mt[p]=!0,yt.insertRule(`@keyframes ${p} ${u}`,yt.cssRules.length)}const f=e.style.animation||"";return e.style.animation=`${f?`${f}, `:""}${p} ${r}ms linear ${o}ms 1 both`,Nt+=1,p}function Rt(e,t){e.style.animation=(e.style.animation||"").split(", ").filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")).join(", "),t&&!--Nt&&dt(()=>{if(Nt)return;let e=yt.cssRules.length;for(;e--;)yt.deleteRule(e);Mt={}})}function qt(e){Bt=e}function Lt(){if(!Bt)throw new Error("Function called outside component initialization");return Bt}function zt(e){Lt().$$.on_destroy.push(e)}function Ft(){const e=Bt;return(t,n)=>{const r=e.$$.callbacks[t];if(r){const o=jt(t,n);r.slice().forEach(t=>{t.call(e,o)})}}}function Ut(e,t){Lt().$$.context.set(e,t)}function Gt(e){return Lt().$$.context.get(e)}const Ht=[],Kt=[],Vt=[],Wt=[],Jt=Promise.resolve();let Xt,Yt=!1;function Qt(e){Vt.push(e)}function Zt(){const e=new Set;do{for(;Ht.length;){const e=Ht.shift();qt(e),en(e.$$)}for(;Kt.length;)Kt.pop()();for(let t=0;t<Vt.length;t+=1){const n=Vt[t];e.has(n)||(n(),e.add(n))}Vt.length=0}while(Ht.length);for(;Wt.length;)Wt.pop()();Yt=!1}function en(e){e.fragment&&(e.update(e.dirty),it(e.before_update),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_update.forEach(Qt))}function tn(e,t,n){e.dispatchEvent(jt(`${t?"intro":"outro"}${n}`))}const nn=new Set;let rn;function on(){rn={r:0,c:[],p:rn}}function an(){rn.r||it(rn.c),rn=rn.p}function sn(e,t){e&&e.i&&(nn.delete(e),e.i(t))}function cn(e,t,n,r){if(e&&e.o){if(nn.has(e))return;nn.add(e),rn.c.push(()=>{nn.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const ln={duration:0};function un(e,t,n,r){let o=t(e,n),i=r?0:1,a=null,s=null,c=null;function l(){c&&Rt(e,c)}function u(e,t){const n=e.b-i;return t*=Math.abs(n),{a:i,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function p(t){const{delay:n=0,duration:r=300,easing:p=tt,tick:f=et,css:d}=o||ln,h={start:ft()+n,b:t};t||(h.group=rn,rn.r+=1),a?s=h:(d&&(l(),c=Tt(e,i,t,r,n,p,d)),t&&f(0,1),a=u(h,r),Qt(()=>tn(e,t,"start")),function(e){let t;vt||(vt=!0,dt(mt)),new Promise(n=>{ht.add(t=[e,n])})}(t=>{if(s&&t>s.start&&(a=u(s,r),s=null,tn(e,a.b,"start"),d&&(l(),c=Tt(e,i,a.b,a.duration,0,p,o.css))),a)if(t>=a.end)f(i=a.b,1-i),tn(e,a.b,"end"),s||(a.b?l():--a.group.r||it(a.group.c)),a=null;else if(t>=a.start){const e=t-a.start;i=a.a+a.d*p(e/a.duration),f(i,1-i)}return!(!a&&!s)}))}return{run(e){at(o)?(Xt||(Xt=Promise.resolve()).then(()=>{Xt=null}),Xt).then(()=>{o=o(),p(e)}):p(e)},end(){l(),a=s=null}}}const pn="undefined"!=typeof window?window:global;function fn(e,t,n){const{fragment:r,on_mount:o,on_destroy:i,after_update:a}=e.$$;r.m(t,n),Qt(()=>{const t=o.map(rt).filter(at);i?i.push(...t):it(t),e.$$.on_mount=[]}),a.forEach(Qt)}function dn(e,t){e.$$.fragment&&(it(e.$$.on_destroy),e.$$.fragment.d(t),e.$$.on_destroy=e.$$.fragment=null,e.$$.ctx={})}function hn(e,t){e.$$.dirty||(Ht.push(e),Yt||(Yt=!0,Jt.then(Zt)),e.$$.dirty=ot()),e.$$.dirty[t]=!0}function yn(e,t,n,r,o,i){const a=Bt;qt(e);const s=t.props||{},c=e.$$={fragment:null,ctx:null,props:i,update:et,not_equal:o,bound:ot(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:ot(),dirty:null};let l=!1;var u;c.ctx=n?n(e,s,(t,n,r=n)=>(c.ctx&&o(c.ctx[t],c.ctx[t]=r)&&(c.bound[t]&&c.bound[t](r),l&&hn(e,t)),n)):s,c.update(),l=!0,it(c.before_update),c.fragment=r(c.ctx),t.target&&(t.hydrate?c.fragment.l((u=t.target,Array.from(u.childNodes))):c.fragment.c(),t.intro&&sn(e.$$.fragment),fn(e,t.target,t.anchor),Zt()),qt(a)}class vn{$destroy(){dn(this,1),this.$destroy=et}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}const mn=[];function gn(e,t=et){let n;const r=[];function o(t){if(st(e,t)&&(e=t,n)){const t=!mn.length;for(let t=0;t<r.length;t+=1){const n=r[t];n[1](),mn.push(n,e)}if(t){for(let e=0;e<mn.length;e+=2)mn[e][0](mn[e+1]);mn.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(i,a=et){const s=[i,a];return r.push(s),1===r.length&&(n=t(o)||et),i(e),()=>{const e=r.indexOf(s);-1!==e&&r.splice(e,1),0===r.length&&(n(),n=null)}}}}function bn(e){const t=e-1;return t*t*t+1}function xn(e,{delay:t=0,duration:n=400,easing:r=bn,x:o=0,y:i=0,opacity:a=0}){const s=getComputedStyle(e),c=+s.opacity,l="none"===s.transform?"":s.transform,u=c*(1-a);return{delay:t,duration:n,easing:r,css:(e,t)=>`\n\t\t\ttransform: ${l} translate(${(1-e)*o}px, ${(1-e)*i}px);\n\t\t\topacity: ${c-u*t}`}}function wn(e,t,n){const r=Object.create(e);return r.key=t[n][0],r.label=t[n][1].label,r}function kn(e){var t,n,r,o,i=e.label+"";function a(){return e.click_handler(e)}return{c(){t=kt("div"),n=Pt(i),r=Ct(),Dt(t,"class","menu-item svelte-19bfq8g"),St(t,"active",e.pane==e.key),o=It(t,"click",a)},m(e,o){bt(e,t,o),gt(t,n),gt(t,r)},p(r,o){e=o,r.panes&&i!==(i=e.label+"")&&At(n,i),(r.pane||r.panes)&&St(t,"active",e.pane==e.key)},d(e){e&&xt(t),o()}}}function $n(e){var t;let n=Object.entries(e.panes).reverse(),r=[];for(let t=0;t<n.length;t+=1)r[t]=kn(wn(e,n,t));return{c(){t=kt("div");for(let e=0;e<r.length;e+=1)r[e].c();Dt(t,"class","menu svelte-19bfq8g")},m(e,n){bt(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,o){if(e.pane||e.panes){let i;for(n=Object.entries(o.panes).reverse(),i=0;i<n.length;i+=1){const a=wn(o,n,i);r[i]?r[i].p(e,a):(r[i]=kn(a),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},i:et,o:et,d(e){e&&xt(t),wt(r,e)}}}function Pn(e,t,n){let{pane:r,panes:o}=t;const i=Ft();return e.$set=(e=>{"pane"in e&&n("pane",r=e.pane),"panes"in e&&n("panes",o=e.panes)}),{pane:r,panes:o,dispatch:i,click_handler:({key:e})=>i("change",e)}}class Cn extends vn{constructor(e){var t;super(),document.getElementById("svelte-19bfq8g-style")||((t=kt("style")).id="svelte-19bfq8g-style",t.textContent=".menu.svelte-19bfq8g{display:flex;margin-top:-10px;flex-direction:row;border:1px solid #ccc;border-radius:5px 5px 0 0;height:25px;line-height:25px;margin-right:-500px;transform-origin:bottom right;transform:rotate(-90deg) translate(0, -500px)}.menu-item.svelte-19bfq8g{line-height:25px;cursor:pointer;background:#fefefe;color:#555;padding-left:15px;padding-right:15px;text-align:center}.menu-item.svelte-19bfq8g:last-child{border-radius:0 5px 0 0}.menu-item.svelte-19bfq8g:first-child{border-radius:5px 0 0 0}.menu-item.active.svelte-19bfq8g{cursor:default;font-weight:bold;background:#ddd;color:#555}.menu-item.svelte-19bfq8g:hover{background:#ddd;color:#555}",gt(document.head,t)),yn(this,e,Pn,$n,st,["pane","panes"])}}function On(e){var t,n;return{c(){t=kt("div"),n=Pt(e.label),Dt(t,"class","label svelte-1olzq4i")},m(e,r){bt(e,t,r),gt(t,n)},p(e,t){e.label&&At(n,t.label)},d(e){e&&xt(t)}}}function In(e){var t,n,r,o,i,a=e.label&&On(e);return{c(){t=kt("div"),n=kt("div"),r=Pt(e.value),o=Ct(),a&&a.c(),Dt(n,"class","key-box svelte-1olzq4i"),Dt(t,"class","key svelte-1olzq4i"),St(t,"active",e.active),i=[It(window,"keydown",e.Keypress),It(n,"click",e.Activate)]},m(e,i){bt(e,t,i),gt(t,n),gt(n,r),gt(t,o),a&&a.m(t,null)},p(e,n){e.value&&At(r,n.value),n.label?a?a.p(e,n):((a=On(n)).c(),a.m(t,null)):a&&(a.d(1),a=null),e.active&&St(t,"active",n.active)},i:et,o:et,d(e){e&&xt(t),a&&a.d(),it(i)}}}function Dn(e,t,n){let r,{value:o,onPress:i=null,label:a=null,disable:s=!1}=t;const{disableHotkeys:c}=Gt("hotkeys");ct(e,c,e=>{n("$disableHotkeys",r=e)});let l=!1;function u(){n("active",l=!1)}function p(){n("active",l=!0),setTimeout(u,200),i&&setTimeout(i,1)}return e.$set=(e=>{"value"in e&&n("value",o=e.value),"onPress"in e&&n("onPress",i=e.onPress),"label"in e&&n("label",a=e.label),"disable"in e&&n("disable",s=e.disable)}),{value:o,onPress:i,label:a,disable:s,disableHotkeys:c,active:l,Activate:p,Keypress:function(e){r||s||e.key!=o||(e.preventDefault(),p())}}}class An extends vn{constructor(e){var t;super(),document.getElementById("svelte-1olzq4i-style")||((t=kt("style")).id="svelte-1olzq4i-style",t.textContent=".key.svelte-1olzq4i{display:flex;flex-direction:row;align-items:center}.key-box.svelte-1olzq4i{cursor:pointer;min-width:10px;padding-left:5px;padding-right:5px;height:20px;line-height:20px;text-align:center;border:1px solid #ccc;box-shadow:1px 1px 1px #888;background:#eee;color:#444}.key-box.svelte-1olzq4i:hover{background:#ddd}.key.active.svelte-1olzq4i .key-box.svelte-1olzq4i{background:#ddd;border:1px solid #999;box-shadow:none}.label.svelte-1olzq4i{margin-left:10px}",gt(document.head,t)),yn(this,e,Dn,In,st,["value","onPress","label","disable"])}}function _n(e){var t,n,r,o,i,a;return{c(){t=kt("div"),n=Pt(e.name),r=Pt("("),o=kt("span"),i=Pt(")"),Dt(o,"class","arg-field svelte-khot71"),Dt(o,"contenteditable",""),Dt(t,"class","move svelte-khot71"),St(t,"active",e.active),a=[It(o,"blur",e.Deactivate),It(o,"keydown",e.OnKeyDown),It(t,"click",e.Activate)]},m(a,s){bt(a,t,s),gt(t,n),gt(t,r),gt(t,o),e.span_1_binding(o),gt(t,i)},p(e,r){e.name&&At(n,r.name),e.active&&St(t,"active",r.active)},i:et,o:et,d(n){n&&xt(t),e.span_1_binding(null),it(a)}}}function En(e,t,n){let r,{Activate:o,Deactivate:i,name:a,active:s}=t;const c=Ft();var l;return l=(()=>{s?r.focus():r.blur()}),Lt().$$.after_update.push(l),e.$set=(e=>{"Activate"in e&&n("Activate",o=e.Activate),"Deactivate"in e&&n("Deactivate",i=e.Deactivate),"name"in e&&n("name",a=e.name),"active"in e&&n("active",s=e.active)}),{Activate:o,Deactivate:i,name:a,active:s,span:r,OnKeyDown:function(e){"Enter"==e.key&&(e.preventDefault(),function(){try{const e=r.innerText;let t=new Function(`return [${e}]`)();c("submit",t)}catch(e){c("error",e)}n("span",r.innerText="",r)}()),"Escape"==e.key&&(e.preventDefault(),i())},span_1_binding:function(e){Kt[e?"unshift":"push"](()=>{n("span",r=e)})}}}class Sn extends vn{constructor(e){var t;super(),document.getElementById("svelte-khot71-style")||((t=kt("style")).id="svelte-khot71-style",t.textContent=".move.svelte-khot71{cursor:pointer;margin-left:10px;color:#666}.move.svelte-khot71:hover{color:#333}.move.active.svelte-khot71{color:#111;font-weight:bold}.arg-field.svelte-khot71{outline:none;font-family:monospace}",gt(document.head,t)),yn(this,e,En,_n,st,["Activate","Deactivate","name","active"])}}function jn(e){var t,n;return{c(){t=kt("span"),n=Pt(e.error),Dt(t,"class","move-error svelte-smqssc")},m(e,r){bt(e,t,r),gt(t,n)},p(e,t){e.error&&At(n,t.error)},d(e){e&&xt(t)}}}function Bn(e){var t,n,r,o,i,a=new An({props:{value:e.shortcut,onPress:e.Activate}}),s=new Sn({props:{Activate:e.Activate,Deactivate:e.Deactivate,name:e.name,active:e.active}});s.$on("submit",e.Submit),s.$on("error",e.Error);var c=e.error&&jn(e);return{c(){t=kt("div"),n=kt("div"),a.$$.fragment.c(),r=Ct(),s.$$.fragment.c(),o=Ct(),c&&c.c(),Dt(n,"class","wrapper svelte-smqssc")},m(e,l){bt(e,t,l),gt(t,n),fn(a,n,null),gt(n,r),fn(s,n,null),gt(t,o),c&&c.m(t,null),i=!0},p(e,n){var r={};e.shortcut&&(r.value=n.shortcut),a.$set(r);var o={};e.name&&(o.name=n.name),e.active&&(o.active=n.active),s.$set(o),n.error?c?c.p(e,n):((c=jn(n)).c(),c.m(t,null)):c&&(c.d(1),c=null)},i(e){i||(sn(a.$$.fragment,e),sn(s.$$.fragment,e),i=!0)},o(e){cn(a.$$.fragment,e),cn(s.$$.fragment,e),i=!1},d(e){e&&xt(t),dn(a),dn(s),c&&c.d()}}}function Nn(e,t,n){let{shortcut:r,name:o,fn:i}=t;const{disableHotkeys:a}=Gt("hotkeys");let s="",c=!1;function l(){a.set(!1),n("error",s=""),n("active",c=!1)}return e.$set=(e=>{"shortcut"in e&&n("shortcut",r=e.shortcut),"name"in e&&n("name",o=e.name),"fn"in e&&n("fn",i=e.fn)}),{shortcut:r,name:o,fn:i,error:s,active:c,Activate:function(){a.set(!0),n("active",c=!0)},Deactivate:l,Submit:function(e){n("error",s=""),l(),i.apply(this,e.detail)},Error:function(e){n("error",s=e.detail),Re(e.detail)}}}class Mn extends vn{constructor(e){var t;super(),document.getElementById("svelte-smqssc-style")||((t=kt("style")).id="svelte-smqssc-style",t.textContent=".move-error.svelte-smqssc{color:#a00;font-weight:bold}.wrapper.svelte-smqssc{display:flex;flex-direction:row;align-items:center}",gt(document.head,t)),yn(this,e,Nn,Bn,st,["shortcut","name","fn"])}}var Tn=function(e,t){return{parse:function(t){var n=JSON.parse(t,o).map(r),i=n[0];return"object"==typeof i&&i?function t(n,r,o){return Object.keys(o).reduce(function(o,i){var a=o[i];if(a instanceof e){var s=n[a];"object"!=typeof s||r.has(s)?o[i]=s:(r.add(s),o[i]=t(n,r,s))}return o},o)}(n,new Set,i):i},stringify:function(e){for(var r,o=new Map,i=[],a=[],s=+n(o,i,e),c=function(e,a){if(r)return r=!r,a;switch(typeof a){case"object":if(null===a)return a;case t:return o.get(a)||n(o,i,a)}return a};s<i.length;s++)r=!0,a[s]=JSON.stringify(i[s],c);return"["+a.join(",")+"]"}};function n(t,n,r){var o=e(n.push(r)-1);return t.set(r,o),o}function r(t){return t instanceof e?e(t):t}function o(n,r){return typeof r===t?new e(r):r}}(String,"string");const Rn=Tn.parse,qn=Tn.stringify;function Ln(e){var t,n,r,o,i,a,s,c,l,u=new An({props:{value:"1",onPress:e.client.reset,label:"reset"}}),p=new An({props:{value:"2",onPress:e.Save,label:"save"}}),f=new An({props:{value:"3",onPress:e.Restore,label:"restore"}}),d=new An({props:{value:".",disable:!0,label:"hide"}});return{c(){t=kt("section"),n=kt("li"),u.$$.fragment.c(),r=Ct(),o=kt("li"),p.$$.fragment.c(),i=Ct(),a=kt("li"),f.$$.fragment.c(),s=Ct(),c=kt("li"),d.$$.fragment.c(),Dt(n,"class","svelte-1x2w9i0"),Dt(o,"class","svelte-1x2w9i0"),Dt(a,"class","svelte-1x2w9i0"),Dt(c,"class","svelte-1x2w9i0"),Dt(t,"id","debug-controls"),Dt(t,"class","controls")},m(e,h){bt(e,t,h),gt(t,n),fn(u,n,null),gt(t,r),gt(t,o),fn(p,o,null),gt(t,i),gt(t,a),fn(f,a,null),gt(t,s),gt(t,c),fn(d,c,null),l=!0},p(e,t){var n={};e.client&&(n.onPress=t.client.reset),u.$set(n)},i(e){l||(sn(u.$$.fragment,e),sn(p.$$.fragment,e),sn(f.$$.fragment,e),sn(d.$$.fragment,e),l=!0)},o(e){cn(u.$$.fragment,e),cn(p.$$.fragment,e),cn(f.$$.fragment,e),cn(d.$$.fragment,e),l=!1},d(e){e&&xt(t),dn(u),dn(p),dn(f),dn(d)}}}function zn(e,t,n){let{client:r}=t;return e.$set=(e=>{"client"in e&&n("client",r=e.client)}),{client:r,Save:function(){const{G:e,ctx:t}=r.getState(),n=qn({G:e,ctx:t});window.localStorage.setItem("gamestate",n)},Restore:function(){const e=window.localStorage.getItem("gamestate");if(null!==e){const t=Rn(e);r.store.dispatch(M(t))}}}}class Fn extends vn{constructor(e){var t;super(),document.getElementById("svelte-1x2w9i0-style")||((t=kt("style")).id="svelte-1x2w9i0-style",t.textContent="li.svelte-1x2w9i0{list-style:none;margin:none;margin-bottom:5px}",gt(document.head,t)),yn(this,e,zn,Ln,st,["client"])}}function Un(e,t,n){const r=Object.create(e);return r.player=t[n],r}function Gn(e){var t,n,r,o,i=e.player+"";function a(){return e.click_handler(e)}return{c(){t=kt("div"),n=Pt(i),r=Ct(),Dt(t,"class","player svelte-6sf87x"),St(t,"current",e.player==e.ctx.currentPlayer),St(t,"active",e.player==e.playerID),o=It(t,"click",a)},m(e,o){bt(e,t,o),gt(t,n),gt(t,r)},p(r,o){e=o,r.players&&i!==(i=e.player+"")&&At(n,i),(r.players||r.ctx)&&St(t,"current",e.player==e.ctx.currentPlayer),(r.players||r.playerID)&&St(t,"active",e.player==e.playerID)},d(e){e&&xt(t),o()}}}function Hn(e){var t;let n=e.players,r=[];for(let t=0;t<n.length;t+=1)r[t]=Gn(Un(e,n,t));return{c(){t=kt("div");for(let e=0;e<r.length;e+=1)r[e].c();Dt(t,"class","player-box svelte-6sf87x")},m(e,n){bt(e,t,n);for(let e=0;e<r.length;e+=1)r[e].m(t,null)},p(e,o){if(e.players||e.ctx||e.playerID){let i;for(n=o.players,i=0;i<n.length;i+=1){const a=Un(o,n,i);r[i]?r[i].p(e,a):(r[i]=Gn(a),r[i].c(),r[i].m(t,null))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},i:et,o:et,d(e){e&&xt(t),wt(r,e)}}}function Kn(e,t,n){let{ctx:r,playerID:o,onClick:i=(()=>{})}=t;const a=Ft();function s(e){a("change",e==o?{playerID:null}:{playerID:e})}let c;return e.$set=(e=>{"ctx"in e&&n("ctx",r=e.ctx),"playerID"in e&&n("playerID",o=e.playerID),"onClick"in e&&n("onClick",i=e.onClick)}),e.$$.update=((e={ctx:1})=>{e.ctx&&n("players",c=r?[...Array(r.numPlayers).keys()].map(e=>e.toString()):[])}),{ctx:r,playerID:o,onClick:i,OnClick:s,players:c,click_handler:({player:e})=>s(e)}}class Vn extends vn{constructor(e){var t;super(),document.getElementById("svelte-6sf87x-style")||((t=kt("style")).id="svelte-6sf87x-style",t.textContent=".player-box.svelte-6sf87x{display:flex;flex-direction:row}.player.svelte-6sf87x{cursor:pointer;text-align:center;width:30px;height:30px;line-height:30px;background:#eee;border:3px solid #fefefe;box-sizing:content-box}.player.current.svelte-6sf87x{background:#555;color:#eee;font-weight:bold}.player.active.svelte-6sf87x{border:3px solid #ff7f50}",gt(document.head,t)),yn(this,e,Kn,Hn,st,["ctx","playerID","onClick"])}}function Wn(e,t,n){const r=Object.create(e);return r.name=t[n][0],r.fn=t[n][1],r}function Jn(e){var t,n,r,o=new Mn({props:{shortcut:e.shortcuts[e.name],fn:e.fn,name:e.name}});return{c(){t=kt("li"),o.$$.fragment.c(),n=Ct(),Dt(t,"class","svelte-1vg2l2b")},m(e,i){bt(e,t,i),fn(o,t,null),gt(t,n),r=!0},p(e,t){var n={};e.client&&(n.shortcut=t.shortcuts[t.name]),e.client&&(n.fn=t.fn),e.client&&(n.name=t.name),o.$set(n)},i(e){r||(sn(o.$$.fragment,e),r=!0)},o(e){cn(o.$$.fragment,e),r=!1},d(e){e&&xt(t),dn(o)}}}function Xn(e){var t,n;return{c(){(t=kt("button")).textContent="End Turn",Dt(t,"class","svelte-1vg2l2b"),n=It(t,"click",e.click_handler)},m(e,n){bt(e,t,n)},d(e){e&&xt(t),n()}}}function Yn(e){var t,n;return{c(){(t=kt("button")).textContent="End Phase",Dt(t,"class","svelte-1vg2l2b"),n=It(t,"click",e.click_handler_1)},m(e,n){bt(e,t,n)},d(e){e&&xt(t),n()}}}function Qn(e){var t,n;return{c(){(t=kt("button")).textContent="End Stage",Dt(t,"class","svelte-1vg2l2b"),n=It(t,"click",e.click_handler_2)},m(e,n){bt(e,t,n)},d(e){e&&xt(t),n()}}}function Zn(e){var t,n,r,o,i,a,s,c,l,u,p,f,d,h,y,v,m,g,b,x,w,k,$,P,C,O,I,D,A,_,E,S=JSON.stringify(e.G,null,2)+"",j=JSON.stringify(er(e.ctx),null,2)+"",B=new Fn({props:{client:e.client}}),N=new Vn({props:{ctx:e.ctx,playerID:e.playerID}});N.$on("change",e.change_handler);let M=Object.entries(e.client.moves),T=[];for(let t=0;t<M.length;t+=1)T[t]=Jn(Wn(e,M,t));const R=e=>cn(T[e],1,1,()=>{T[e]=null});var q=e.client.events.endTurn&&Xn(e),L=e.ctx.phase&&e.client.events.endPhase&&Yn(e),z=e.ctx.activePlayers&&e.client.events.endStage&&Qn(e);return{c(){t=kt("section"),(n=kt("h3")).textContent="Controls",r=Ct(),B.$$.fragment.c(),o=Ct(),i=kt("section"),(a=kt("h3")).textContent="Players",s=Ct(),N.$$.fragment.c(),c=Ct(),l=kt("section"),(u=kt("h3")).textContent="Moves",p=Ct();for(let e=0;e<T.length;e+=1)T[e].c();f=Ct(),d=kt("section"),(h=kt("h3")).textContent="Events",y=Ct(),v=kt("div"),q&&q.c(),m=Ct(),L&&L.c(),g=Ct(),z&&z.c(),b=Ct(),x=kt("section"),(w=kt("label")).textContent="G",k=Ct(),$=kt("pre"),P=Pt(S),C=Ct(),O=kt("section"),(I=kt("label")).textContent="ctx",D=Ct(),A=kt("pre"),_=Pt(j),Dt(n,"class","svelte-1vg2l2b"),Dt(a,"class","svelte-1vg2l2b"),Dt(u,"class","svelte-1vg2l2b"),Dt(h,"class","svelte-1vg2l2b"),Dt(v,"class","events svelte-1vg2l2b"),Dt(w,"class","svelte-1vg2l2b"),Dt($,"class","json svelte-1vg2l2b"),Dt(I,"class","svelte-1vg2l2b"),Dt(A,"class","json svelte-1vg2l2b")},m(e,S){bt(e,t,S),gt(t,n),gt(t,r),fn(B,t,null),bt(e,o,S),bt(e,i,S),gt(i,a),gt(i,s),fn(N,i,null),bt(e,c,S),bt(e,l,S),gt(l,u),gt(l,p);for(let e=0;e<T.length;e+=1)T[e].m(l,null);bt(e,f,S),bt(e,d,S),gt(d,h),gt(d,y),gt(d,v),q&&q.m(v,null),gt(v,m),L&&L.m(v,null),gt(v,g),z&&z.m(v,null),bt(e,b,S),bt(e,x,S),gt(x,w),gt(x,k),gt(x,$),gt($,P),bt(e,C,S),bt(e,O,S),gt(O,I),gt(O,D),gt(O,A),gt(A,_),E=!0},p(e,t){var n={};e.client&&(n.client=t.client),B.$set(n);var r={};if(e.ctx&&(r.ctx=t.ctx),e.playerID&&(r.playerID=t.playerID),N.$set(r),e.shortcuts||e.client){let n;for(M=Object.entries(t.client.moves),n=0;n<M.length;n+=1){const r=Wn(t,M,n);T[n]?(T[n].p(e,r),sn(T[n],1)):(T[n]=Jn(r),T[n].c(),sn(T[n],1),T[n].m(l,null))}for(on(),n=M.length;n<T.length;n+=1)R(n);an()}t.client.events.endTurn?q||((q=Xn(t)).c(),q.m(v,m)):q&&(q.d(1),q=null),t.ctx.phase&&t.client.events.endPhase?L||((L=Yn(t)).c(),L.m(v,g)):L&&(L.d(1),L=null),t.ctx.activePlayers&&t.client.events.endStage?z||((z=Qn(t)).c(),z.m(v,null)):z&&(z.d(1),z=null),E&&!e.G||S===(S=JSON.stringify(t.G,null,2)+"")||At(P,S),E&&!e.ctx||j===(j=JSON.stringify(er(t.ctx),null,2)+"")||At(_,j)},i(e){if(!E){sn(B.$$.fragment,e),sn(N.$$.fragment,e);for(let e=0;e<M.length;e+=1)sn(T[e]);E=!0}},o(e){cn(B.$$.fragment,e),cn(N.$$.fragment,e),T=T.filter(Boolean);for(let e=0;e<T.length;e+=1)cn(T[e]);E=!1},d(e){e&&xt(t),dn(B),e&&(xt(o),xt(i)),dn(N),e&&(xt(c),xt(l)),wt(T,e),e&&(xt(f),xt(d)),q&&q.d(),L&&L.d(),z&&z.d(),e&&(xt(b),xt(x),xt(C),xt(O))}}}function er(e){let t={};for(const n in e)n.startsWith("_")||(t[n]=e[n]);return t}function tr(e,t,n){let{client:r}=t;const o=function(e,t,n){var r={},o={};for(var i in e)o[i]=i;for(var a in t)o[a]=a;for(var s={},c=0;c<n.length;c++)s[n[c]]=!0;var l=s,u=!0;for(var p in o){var f=p[0];if(l[f]){u=!1;break}l[f]=!0,r[p]=f}if(u)return r;l=s;var d=97;for(var h in r={},o){for(var y=String.fromCharCode(d);l[y];)d++,y=String.fromCharCode(d);l[y]=!0,r[h]=y}return r}(r.moves,r.events,"mlia");let i=r.playerID,a={},s={};r.subscribe(e=>{e&&(n("G",s=e.G),n("ctx",a=e.ctx)),n("playerID",i=r.playerID)});return e.$set=(e=>{"client"in e&&n("client",r=e.client)}),{client:r,shortcuts:o,playerID:i,ctx:a,G:s,change_handler:e=>r.updatePlayerID(e.detail.playerID),click_handler:()=>r.events.endTurn(),click_handler_1:()=>r.events.endPhase(),click_handler_2:()=>r.events.endStage()}}class nr extends vn{constructor(e){var t;super(),document.getElementById("svelte-1vg2l2b-style")||((t=kt("style")).id="svelte-1vg2l2b-style",t.textContent=".json.svelte-1vg2l2b{font-family:monospace;color:#888}label.svelte-1vg2l2b{font-weight:bold;font-size:1.1em;display:inline}h3.svelte-1vg2l2b{text-transform:uppercase}li.svelte-1vg2l2b{list-style:none;margin:none;margin-bottom:5px}.events.svelte-1vg2l2b{display:flex;flex-direction:column}.events.svelte-1vg2l2b button.svelte-1vg2l2b{width:100px}.events.svelte-1vg2l2b button.svelte-1vg2l2b:not(:last-child){margin-bottom:10px}",gt(document.head,t)),yn(this,e,tr,Zn,st,["client"])}}function rr(e){var t,n,r,o,i,a,s=JSON.stringify(e.value)+"";return{c(){t=kt("div"),n=kt("strong"),r=Pt(e.name),o=Ct(),i=kt("div"),a=Pt(s),Dt(i,"class","svelte-13qih23"),Dt(t,"class","item svelte-13qih23")},m(e,s){bt(e,t,s),gt(t,n),gt(n,r),gt(t,o),gt(t,i),gt(i,a)},p(e,t){e.name&&At(r,t.name),e.value&&s!==(s=JSON.stringify(t.value)+"")&&At(a,s)},i:et,o:et,d(e){e&&xt(t)}}}function or(e,t,n){let{name:r,value:o}=t;return e.$set=(e=>{"name"in e&&n("name",r=e.name),"value"in e&&n("value",o=e.value)}),{name:r,value:o}}class ir extends vn{constructor(e){var t;super(),document.getElementById("svelte-13qih23-style")||((t=kt("style")).id="svelte-13qih23-style",t.textContent=".item.svelte-13qih23{padding:10px}.item.svelte-13qih23:not(:first-child){border-top:1px dashed #aaa}.item.svelte-13qih23 div.svelte-13qih23{float:right;text-align:right}",gt(document.head,t)),yn(this,e,or,rr,st,["name","value"])}}function ar(e){var t,n,r,o=new ir({props:{name:"isConnected",value:e.$client.isConnected}}),i=new ir({props:{name:"isMultiplayer",value:e.$client.isMultiplayer}});return{c(){t=kt("span"),o.$$.fragment.c(),n=Ct(),i.$$.fragment.c()},m(e,a){bt(e,t,a),fn(o,t,null),gt(t,n),fn(i,t,null),r=!0},p(e,t){var n={};e.$client&&(n.value=t.$client.isConnected),o.$set(n);var r={};e.$client&&(r.value=t.$client.isMultiplayer),i.$set(r)},i(e){r||(sn(o.$$.fragment,e),sn(i.$$.fragment,e),r=!0)},o(e){cn(o.$$.fragment,e),cn(i.$$.fragment,e),r=!1},d(e){e&&xt(t),dn(o),dn(i)}}}function sr(e){var t,n,r,o,i,a=new ir({props:{name:"gameID",value:e.client.gameID}}),s=new ir({props:{name:"playerID",value:e.client.playerID}}),c=new ir({props:{name:"isActive",value:e.$client.isActive}}),l=e.$client.isMultiplayer&&ar(e);return{c(){t=kt("section"),a.$$.fragment.c(),n=Ct(),s.$$.fragment.c(),r=Ct(),c.$$.fragment.c(),o=Ct(),l&&l.c(),Dt(t,"class","gameinfo svelte-1yzq5o8")},m(e,u){bt(e,t,u),fn(a,t,null),gt(t,n),fn(s,t,null),gt(t,r),fn(c,t,null),gt(t,o),l&&l.m(t,null),i=!0},p(e,n){var r={};e.client&&(r.value=n.client.gameID),a.$set(r);var o={};e.client&&(o.value=n.client.playerID),s.$set(o);var i={};e.$client&&(i.value=n.$client.isActive),c.$set(i),n.$client.isMultiplayer?l?(l.p(e,n),sn(l,1)):((l=ar(n)).c(),sn(l,1),l.m(t,null)):l&&(on(),cn(l,1,1,()=>{l=null}),an())},i(e){i||(sn(a.$$.fragment,e),sn(s.$$.fragment,e),sn(c.$$.fragment,e),sn(l),i=!0)},o(e){cn(a.$$.fragment,e),cn(s.$$.fragment,e),cn(c.$$.fragment,e),cn(l),i=!1},d(e){e&&xt(t),dn(a),dn(s),dn(c),l&&l.d()}}}function cr(e,t,n){let r,{client:o}=t;return ct(e,o,e=>{n("$client",r=e)}),e.$set=(e=>{"client"in e&&n("client",o=e.client)}),{client:o,$client:r}}class lr extends vn{constructor(e){var t;super(),document.getElementById("svelte-1yzq5o8-style")||((t=kt("style")).id="svelte-1yzq5o8-style",t.textContent=".gameinfo.svelte-1yzq5o8{padding:10px}",gt(document.head,t)),yn(this,e,cr,sr,st,["client"])}}function ur(e){var t,n;return{c(){t=kt("div"),n=Pt(e.turn),Dt(t,"class","turn-marker svelte-6eza86"),Dt(t,"style",e.style)},m(e,r){bt(e,t,r),gt(t,n)},p(e,t){e.turn&&At(n,t.turn)},i:et,o:et,d(e){e&&xt(t)}}}function pr(e,t,n){let{turn:r,numEvents:o}=t;const i=`grid-row: span ${o}`;return e.$set=(e=>{"turn"in e&&n("turn",r=e.turn),"numEvents"in e&&n("numEvents",o=e.numEvents)}),{turn:r,numEvents:o,style:i}}class fr extends vn{constructor(e){var t;super(),document.getElementById("svelte-6eza86-style")||((t=kt("style")).id="svelte-6eza86-style",t.textContent=".turn-marker.svelte-6eza86{display:flex;justify-content:center;align-items:center;grid-column:1;background:#555;color:#eee;text-align:center;font-weight:bold;border:1px solid #888}",gt(document.head,t)),yn(this,e,pr,ur,st,["turn","numEvents"])}}function dr(e){var t,n,r=e.phase||"";return{c(){t=kt("div"),n=Pt(r),Dt(t,"class","phase-marker svelte-1t4xap"),Dt(t,"style",e.style)},m(e,r){bt(e,t,r),gt(t,n)},p(e,t){e.phase&&r!==(r=t.phase||"")&&At(n,r)},i:et,o:et,d(e){e&&xt(t)}}}function hr(e,t,n){let{phase:r,numEvents:o}=t;const i=`grid-row: span ${o}`;return e.$set=(e=>{"phase"in e&&n("phase",r=e.phase),"numEvents"in e&&n("numEvents",o=e.numEvents)}),{phase:r,numEvents:o,style:i}}class yr extends vn{constructor(e){var t;super(),document.getElementById("svelte-1t4xap-style")||((t=kt("style")).id="svelte-1t4xap-style",t.textContent=".phase-marker.svelte-1t4xap{grid-column:3;background:#555;border:1px solid #888;color:#eee;text-align:center;font-weight:bold;padding-top:10px;padding-bottom:10px;text-orientation:sideways;writing-mode:vertical-rl;line-height:30px;width:100%}",gt(document.head,t)),yn(this,e,hr,dr,st,["phase","numEvents"])}}function vr(e){var t,n;return{c(){t=kt("div"),n=Pt(e.custompayload)},m(e,r){bt(e,t,r),gt(t,n)},p:et,i:et,o:et,d(e){e&&xt(t)}}}function mr(e,t,n){let{payload:r}=t;const o=void 0!==r?JSON.stringify(r,null,4):"";return e.$set=(e=>{"payload"in e&&n("payload",r=e.payload)}),{payload:r,custompayload:o}}class gr extends vn{constructor(e){super(),yn(this,e,mr,vr,st,["payload"])}}function br(e){var t,n=new gr({props:{payload:e.payload}});return{c(){n.$$.fragment.c()},m(e,r){fn(n,e,r),t=!0},p(e,t){var r={};e.payload&&(r.payload=t.payload),n.$set(r)},i(e){t||(sn(n.$$.fragment,e),t=!0)},o(e){cn(n.$$.fragment,e),t=!1},d(e){dn(n,e)}}}function xr(e){var t,n,r=e.payloadComponent;function o(e){return{props:{payload:e.payload}}}if(r)var i=new r(o(e));return{c(){i&&i.$$.fragment.c(),t=Ot()},m(e,r){i&&fn(i,e,r),bt(e,t,r),n=!0},p(e,n){var a={};if(e.payload&&(a.payload=n.payload),r!==(r=n.payloadComponent)){if(i){on();const e=i;cn(e.$$.fragment,1,0,()=>{dn(e,1)}),an()}r?((i=new r(o(n))).$$.fragment.c(),sn(i.$$.fragment,1),fn(i,t.parentNode,t)):i=null}else r&&i.$set(a)},i(e){n||(i&&sn(i.$$.fragment,e),n=!0)},o(e){i&&cn(i.$$.fragment,e),n=!1},d(e){e&&xt(t),i&&dn(i,e)}}}function wr(e){var t,n,r,o,i,a,s,c,l,u,p,f=e.action.payload.type+"",d=e.args.join(",")+"",h=[xr,br],y=[];function v(e,t){return t.payloadComponent?0:1}return c=v(0,e),l=y[c]=h[c](e),{c(){t=kt("div"),n=kt("div"),r=Pt(f),o=Pt("("),i=Pt(d),a=Pt(")"),s=Ct(),l.c(),Dt(t,"class","log-event player"+e.playerID+" svelte-10wdo7v"),St(t,"pinned",e.pinned),p=[It(t,"click",e.click_handler),It(t,"mouseenter",e.mouseenter_handler),It(t,"mouseleave",e.mouseleave_handler)]},m(e,l){bt(e,t,l),gt(t,n),gt(n,r),gt(n,o),gt(n,i),gt(n,a),gt(t,s),y[c].m(t,null),u=!0},p(e,n){u&&!e.action||f===(f=n.action.payload.type+"")||At(r,f);var o=c;(c=v(0,n))===o?y[c].p(e,n):(on(),cn(y[o],1,1,()=>{y[o]=null}),an(),(l=y[c])||(l=y[c]=h[c](n)).c(),sn(l,1),l.m(t,null)),e.pinned&&St(t,"pinned",n.pinned)},i(e){u||(sn(l),u=!0)},o(e){cn(l),u=!1},d(e){e&&xt(t),y[c].d(),it(p)}}}function kr(e,t,n){let{logIndex:r,onLogClick:o,onMouseEnter:i,onMouseLeave:a,action:s,pinned:c,payload:l,payloadComponent:u}=t;const p=Ft(),f=s.payload.args||[],d=s.payload.playerID;return e.$set=(e=>{"logIndex"in e&&n("logIndex",r=e.logIndex),"onLogClick"in e&&n("onLogClick",o=e.onLogClick),"onMouseEnter"in e&&n("onMouseEnter",i=e.onMouseEnter),"onMouseLeave"in e&&n("onMouseLeave",a=e.onMouseLeave),"action"in e&&n("action",s=e.action),"pinned"in e&&n("pinned",c=e.pinned),"payload"in e&&n("payload",l=e.payload),"payloadComponent"in e&&n("payloadComponent",u=e.payloadComponent)}),{logIndex:r,onLogClick:o,onMouseEnter:i,onMouseLeave:a,action:s,pinned:c,payload:l,payloadComponent:u,dispatch:p,args:f,playerID:d,click_handler:()=>p("click",{logIndex:r}),mouseenter_handler:()=>p("mouseenter",{logIndex:r}),mouseleave_handler:()=>p("mouseleave")}}class $r extends vn{constructor(e){var t;super(),document.getElementById("svelte-10wdo7v-style")||((t=kt("style")).id="svelte-10wdo7v-style",t.textContent=".log-event.svelte-10wdo7v{grid-column:2;cursor:pointer;overflow:hidden;display:flex;flex-direction:column;justify-content:center;background:#fff;border:1px dotted #ccc;border-left:5px solid #ccc;padding:5px;text-align:center;color:#888;font-size:14px;min-height:25px;line-height:25px}.log-event.svelte-10wdo7v:hover{border-style:solid;background:#eee}.log-event.pinned.svelte-10wdo7v{border-style:solid;background:#eee;opacity:1}.player0.svelte-10wdo7v{border-left-color:#ff851b}.player1.svelte-10wdo7v{border-left-color:#7fdbff}.player2.svelte-10wdo7v{border-left-color:#0074d9}.player3.svelte-10wdo7v{border-left-color:#39cccc}.player4.svelte-10wdo7v{border-left-color:#3d9970}.player5.svelte-10wdo7v{border-left-color:#2ecc40}.player6.svelte-10wdo7v{border-left-color:#01ff70}.player7.svelte-10wdo7v{border-left-color:#ffdc00}.player8.svelte-10wdo7v{border-left-color:#001f3f}.player9.svelte-10wdo7v{border-left-color:#ff4136}.player10.svelte-10wdo7v{border-left-color:#85144b}.player11.svelte-10wdo7v{border-left-color:#f012be}.player12.svelte-10wdo7v{border-left-color:#b10dc9}.player13.svelte-10wdo7v{border-left-color:#111111}.player14.svelte-10wdo7v{border-left-color:#aaaaaa}.player15.svelte-10wdo7v{border-left-color:#dddddd}",gt(document.head,t)),yn(this,e,kr,wr,st,["logIndex","onLogClick","onMouseEnter","onMouseLeave","action","pinned","payload","payloadComponent"])}}function Pr(e){var t,n;return{c(){t=$t("title"),n=Pt(e.title)},m(e,r){bt(e,t,r),gt(t,n)},p(e,t){e.title&&At(n,t.title)},d(e){e&&xt(t)}}}function Cr(e){var t,n,r,o=e.title&&Pr(e);const i=e.$$slots.default,a=function(e,t,n){if(e){const r=lt(e,t,n);return e[0](r)}}(i,e,null);return{c(){t=$t("svg"),o&&o.c(),n=Ot(),a&&a.c(),Dt(t,"xmlns","http://www.w3.org/2000/svg"),Dt(t,"viewBox",e.viewBox),Dt(t,"class","svelte-c8tyih")},l(e){a&&a.l(svg_nodes)},m(e,i){bt(e,t,i),o&&o.m(t,null),gt(t,n),a&&a.m(t,null),r=!0},p(e,s){s.title?o?o.p(e,s):((o=Pr(s)).c(),o.m(t,n)):o&&(o.d(1),o=null),a&&a.p&&e.$$scope&&a.p(function(e,t,n,r){return e[1]?nt({},nt(t.$$scope.changed||{},e[1](r?r(n):{}))):t.$$scope.changed||{}}(i,s,e,null),lt(i,s,null)),r&&!e.viewBox||Dt(t,"viewBox",s.viewBox)},i(e){r||(sn(a,e),r=!0)},o(e){cn(a,e),r=!1},d(e){e&&xt(t),o&&o.d(),a&&a.d(e)}}}function Or(e,t,n){let{title:r=null,viewBox:o}=t,{$$slots:i={},$$scope:a}=t;return e.$set=(e=>{"title"in e&&n("title",r=e.title),"viewBox"in e&&n("viewBox",o=e.viewBox),"$$scope"in e&&n("$$scope",a=e.$$scope)}),{title:r,viewBox:o,$$slots:i,$$scope:a}}class Ir extends vn{constructor(e){var t;super(),document.getElementById("svelte-c8tyih-style")||((t=kt("style")).id="svelte-c8tyih-style",t.textContent="svg.svelte-c8tyih{stroke:currentColor;fill:currentColor;stroke-width:0;width:100%;height:auto;max-height:100%}",gt(document.head,t)),yn(this,e,Or,Cr,st,["title","viewBox"])}}function Dr(e){var t;return{c(){Dt(t=$t("path"),"d","M504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zM212 140v116h-70.9c-10.7 0-16.1 13-8.5 20.5l114.9 114.3c4.7 4.7 12.2 4.7 16.9 0l114.9-114.3c7.6-7.6 2.2-20.5-8.5-20.5H300V140c0-6.6-5.4-12-12-12h-64c-6.6 0-12 5.4-12 12z")},m(e,n){bt(e,t,n)},d(e){e&&xt(t)}}}function Ar(e){var t,n=[{viewBox:"0 0 512 512"},e.$$props];let r={$$slots:{default:[Dr]},$$scope:{ctx:e}};for(var o=0;o<n.length;o+=1)r=nt(r,n[o]);var i=new Ir({props:r});return{c(){i.$$.fragment.c()},m(e,n){fn(i,e,n),t=!0},p(e,t){var r,o=e.$$props?function(e,t){const n={},r={},o={$$scope:1};let i=e.length;for(;i--;){const a=e[i],s=t[i];if(s){for(const e in a)e in s||(r[e]=1);for(const e in s)o[e]||(n[e]=s[e],o[e]=1);e[i]=s}else for(const e in a)o[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}(n,[n[0],(r=t.$$props,"object"==typeof r&&null!==r?r:{})]):{};e.$$scope&&(o.$$scope={changed:e,ctx:t}),i.$set(o)},i(e){t||(sn(i.$$.fragment,e),t=!0)},o(e){cn(i.$$.fragment,e),t=!1},d(e){dn(i,e)}}}function _r(e,t,n){return e.$set=(e=>{n("$$props",t=nt(nt({},t),e))}),{$$props:t,$$props:t=ut(t)}}class Er extends vn{constructor(e){super(),yn(this,e,_r,Ar,st,[])}}function Sr(e){var t,n;return{c(){t=kt("div"),n=Pt(e.text),Dt(t,"alt",e.text),Dt(t,"class","svelte-1a7time")},m(e,r){bt(e,t,r),gt(t,n)},p(e,r){e.text&&(At(n,r.text),Dt(t,"alt",r.text))},i:et,o:et,d(e){e&&xt(t)}}}function jr(e,t,n){let r,{action:o}=t;return e.$set=(e=>{"action"in e&&n("action",o=e.action)}),e.$$.update=((e={action:1})=>{if(e.action){const{type:e,args:t}=o.payload,i=(t||[]).join(",");n("text",r=`${e}(${i})`)}}),{action:o,text:r}}class Br extends vn{constructor(e){var t;super(),document.getElementById("svelte-1a7time-style")||((t=kt("style")).id="svelte-1a7time-style",t.textContent="div.svelte-1a7time{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:500px}",gt(document.head,t)),yn(this,e,jr,Sr,st,["action"])}}function Nr(e,t,n){const r=Object.create(e);return r.child=t[n],r.i=n,r}function Mr(e){var t,n,r,o,i,a,s,c,l,u,p,f=e.child.value+"",d=e.child.visits+"",h=new Br({props:{action:e.child.parentAction}});function y(){return e.click_handler(e)}function v(){return e.mouseout_handler(e)}function m(){return e.mouseover_handler(e)}return{c(){t=kt("tr"),n=kt("td"),r=Pt(f),o=Ct(),i=kt("td"),a=Pt(d),s=Ct(),c=kt("td"),h.$$.fragment.c(),l=Ct(),Dt(n,"class","svelte-ztcwsu"),Dt(i,"class","svelte-ztcwsu"),Dt(c,"class","svelte-ztcwsu"),Dt(t,"class","svelte-ztcwsu"),St(t,"clickable",e.children.length>0),St(t,"selected",e.i===e.selectedIndex),p=[It(t,"click",y),It(t,"mouseout",v),It(t,"mouseover",m)]},m(e,p){bt(e,t,p),gt(t,n),gt(n,r),gt(t,o),gt(t,i),gt(i,a),gt(t,s),gt(t,c),fn(h,c,null),gt(t,l),u=!0},p(n,o){e=o,u&&!n.children||f===(f=e.child.value+"")||At(r,f),u&&!n.children||d===(d=e.child.visits+"")||At(a,d);var i={};n.children&&(i.action=e.child.parentAction),h.$set(i),n.children&&St(t,"clickable",e.children.length>0),n.selectedIndex&&St(t,"selected",e.i===e.selectedIndex)},i(e){u||(sn(h.$$.fragment,e),u=!0)},o(e){cn(h.$$.fragment,e),u=!1},d(e){e&&xt(t),dn(h),it(p)}}}function Tr(e){var t,n,r,o,i;let a=e.children,s=[];for(let t=0;t<a.length;t+=1)s[t]=Mr(Nr(e,a,t));const c=e=>cn(s[e],1,1,()=>{s[e]=null});return{c(){t=kt("table"),(n=kt("thead")).innerHTML='<th class="svelte-ztcwsu">Value</th> <th class="svelte-ztcwsu">Visits</th> <th class="svelte-ztcwsu">Action</th>',r=Ct(),o=kt("tbody");for(let e=0;e<s.length;e+=1)s[e].c();Dt(t,"class","svelte-ztcwsu")},m(e,a){bt(e,t,a),gt(t,n),gt(t,r),gt(t,o);for(let e=0;e<s.length;e+=1)s[e].m(o,null);i=!0},p(e,t){if(e.children||e.selectedIndex){let n;for(a=t.children,n=0;n<a.length;n+=1){const r=Nr(t,a,n);s[n]?(s[n].p(e,r),sn(s[n],1)):(s[n]=Mr(r),s[n].c(),sn(s[n],1),s[n].m(o,null))}for(on(),n=a.length;n<s.length;n+=1)c(n);an()}},i(e){if(!i){for(let e=0;e<a.length;e+=1)sn(s[e]);i=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)cn(s[e]);i=!1},d(e){e&&xt(t),wt(s,e)}}}function Rr(e,t,n){let{root:r,selectedIndex:o=null}=t;const i=Ft();let a=[],s=[];function c(e,t){i("select",{node:e,selectedIndex:t})}function l(e,t){null===o&&i("preview",{node:e})}return e.$set=(e=>{"root"in e&&n("root",r=e.root),"selectedIndex"in e&&n("selectedIndex",o=e.selectedIndex)}),e.$$.update=((e={root:1,parents:1})=>{if(e.root||e.parents){let e=r;for(n("parents",a=[]);e.parent;){const t=e.parent,{type:n,args:r}=e.parentAction.payload,o=`${n}(${(r||[]).join(",")})`;a.push({parent:t,arrowText:o}),e=t}a.reverse(),n("children",s=[...r.children].sort((e,t)=>e.visits<t.visits?1:-1).slice(0,50))}}),{root:r,selectedIndex:o,children:s,Select:c,Preview:l,click_handler:({child:e,i:t})=>c(e,t),mouseout_handler:({i:e})=>l(null),mouseover_handler:({child:e,i:t})=>l(e)}}class qr extends vn{constructor(e){var t;super(),document.getElementById("svelte-ztcwsu-style")||((t=kt("style")).id="svelte-ztcwsu-style",t.textContent="table.svelte-ztcwsu{font-size:12px;border-collapse:collapse;border:1px solid #ddd;padding:0}tr.svelte-ztcwsu{cursor:pointer}tr.svelte-ztcwsu:hover td.svelte-ztcwsu{background:#eee}tr.selected.svelte-ztcwsu td.svelte-ztcwsu{background:#eee}td.svelte-ztcwsu{padding:10px;height:10px;line-height:10px;font-size:12px;border:none}th.svelte-ztcwsu{background:#888;color:#fff;padding:10px;text-align:center}",gt(document.head,t)),yn(this,e,Rr,Tr,st,["root","selectedIndex"])}}function Lr(e,t,n){const r=Object.create(e);return r.node=t[n].node,r.selectedIndex=t[n].selectedIndex,r.i=n,r}function zr(e){var t;var n=new qr({props:{root:e.node,selectedIndex:e.selectedIndex}});return n.$on("select",function(...t){return e.select_handler_1(e,...t)}),{c(){n.$$.fragment.c()},m(e,r){fn(n,e,r),t=!0},p(t,r){e=r;var o={};t.nodes&&(o.root=e.node),t.nodes&&(o.selectedIndex=e.selectedIndex),n.$set(o)},i(e){t||(sn(n.$$.fragment,e),t=!0)},o(e){cn(n.$$.fragment,e),t=!1},d(e){dn(n,e)}}}function Fr(e){var t;var n=new qr({props:{root:e.node}});return n.$on("select",function(...t){return e.select_handler(e,...t)}),n.$on("preview",function(...t){return e.preview_handler(e,...t)}),{c(){n.$$.fragment.c()},m(e,r){fn(n,e,r),t=!0},p(t,r){e=r;var o={};t.nodes&&(o.root=e.node),n.$set(o)},i(e){t||(sn(n.$$.fragment,e),t=!0)},o(e){cn(n.$$.fragment,e),t=!1},d(e){dn(n,e)}}}function Ur(e){var t,n,r,o,i,a=0!==e.i&&function(e){var t,n,r=new Er({});return{c(){t=kt("div"),r.$$.fragment.c(),Dt(t,"class","icon svelte-1f0amz4")},m(e,o){bt(e,t,o),fn(r,t,null),n=!0},i(e){n||(sn(r.$$.fragment,e),n=!0)},o(e){cn(r.$$.fragment,e),n=!1},d(e){e&&xt(t),dn(r)}}}(),s=[Fr,zr],c=[];function l(e,t){return t.i===t.nodes.length-1?0:1}return r=l(0,e),o=c[r]=s[r](e),{c(){a&&a.c(),t=Ct(),n=kt("section"),o.c()},m(e,o){a&&a.m(e,o),bt(e,t,o),bt(e,n,o),c[r].m(n,null),i=!0},p(e,t){var i=r;(r=l(0,t))===i?c[r].p(e,t):(on(),cn(c[i],1,1,()=>{c[i]=null}),an(),(o=c[r])||(o=c[r]=s[r](t)).c(),sn(o,1),o.m(n,null))},i(e){i||(sn(a),sn(o),i=!0)},o(e){cn(a),cn(o),i=!1},d(e){a&&a.d(e),e&&(xt(t),xt(n)),c[r].d()}}}function Gr(e){var t,n,r,o,i=new Er({}),a=new qr({props:{root:e.preview}});return{c(){t=kt("div"),i.$$.fragment.c(),n=Ct(),r=kt("section"),a.$$.fragment.c(),Dt(t,"class","icon svelte-1f0amz4"),Dt(r,"class","preview svelte-1f0amz4")},m(e,s){bt(e,t,s),fn(i,t,null),bt(e,n,s),bt(e,r,s),fn(a,r,null),o=!0},p(e,t){var n={};e.preview&&(n.root=t.preview),a.$set(n)},i(e){o||(sn(i.$$.fragment,e),sn(a.$$.fragment,e),o=!0)},o(e){cn(i.$$.fragment,e),cn(a.$$.fragment,e),o=!1},d(e){e&&xt(t),dn(i),e&&(xt(n),xt(r)),dn(a)}}}function Hr(e){var t,n,r;let o=e.nodes,i=[];for(let t=0;t<o.length;t+=1)i[t]=Ur(Lr(e,o,t));const a=e=>cn(i[e],1,1,()=>{i[e]=null});var s=e.preview&&Gr(e);return{c(){t=kt("div");for(let e=0;e<i.length;e+=1)i[e].c();n=Ct(),s&&s.c(),Dt(t,"class","visualizer svelte-1f0amz4")},m(e,o){bt(e,t,o);for(let e=0;e<i.length;e+=1)i[e].m(t,null);gt(t,n),s&&s.m(t,null),r=!0},p(e,r){if(e.nodes){let s;for(o=r.nodes,s=0;s<o.length;s+=1){const a=Lr(r,o,s);i[s]?(i[s].p(e,a),sn(i[s],1)):(i[s]=Ur(a),i[s].c(),sn(i[s],1),i[s].m(t,n))}for(on(),s=o.length;s<i.length;s+=1)a(s);an()}r.preview?s?(s.p(e,r),sn(s,1)):((s=Gr(r)).c(),sn(s,1),s.m(t,null)):s&&(on(),cn(s,1,1,()=>{s=null}),an())},i(e){if(!r){for(let e=0;e<o.length;e+=1)sn(i[e]);sn(s),r=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)cn(i[e]);cn(s),r=!1},d(e){e&&xt(t),wt(i,e),s&&s.d()}}}function Kr(e,t,n){let{metadata:r}=t,o=[],i=null;function a({node:e,selectedIndex:t},r){n("preview",i=null),n("nodes",o[r].selectedIndex=t,o),n("nodes",o=[...o.slice(0,r+1),{node:e}])}function s({node:e},t){n("preview",i=e)}return e.$set=(e=>{"metadata"in e&&n("metadata",r=e.metadata)}),e.$$.update=((e={metadata:1})=>{e.metadata&&n("nodes",o=[{node:r}])}),{metadata:r,nodes:o,preview:i,SelectNode:a,PreviewNode:s,select_handler:({i:e},t)=>a(t.detail,e),preview_handler:({i:e},t)=>s(t.detail),select_handler_1:({i:e},t)=>a(t.detail,e)}}class Vr extends vn{constructor(e){var t;super(),document.getElementById("svelte-1f0amz4-style")||((t=kt("style")).id="svelte-1f0amz4-style",t.textContent=".visualizer.svelte-1f0amz4{display:flex;flex-direction:column;align-items:center;padding:50px}.preview.svelte-1f0amz4{opacity:0.5}.icon.svelte-1f0amz4{color:#777;width:32px;height:32px;margin-bottom:20px}",gt(document.head,t)),yn(this,e,Kr,Hr,st,["metadata"])}}function Wr(e,t,n){const r=Object.create(e);return r.phase=t[n].phase,r.i=n,r}function Jr(e,t,n){const r=Object.create(e);return r.action=t[n].action,r.payload=t[n].payload,r.i=n,r}function Xr(e,t,n){const r=Object.create(e);return r.turn=t[n].turn,r.i=n,r}function Yr(e){var t,n=new fr({props:{turn:e.turn,numEvents:e.turnBoundaries[e.i]}});return{c(){n.$$.fragment.c()},m(e,r){fn(n,e,r),t=!0},p(e,t){var r={};e.renderedLogEntries&&(r.turn=t.turn),e.turnBoundaries&&(r.numEvents=t.turnBoundaries[t.i]),n.$set(r)},i(e){t||(sn(n.$$.fragment,e),t=!0)},o(e){cn(n.$$.fragment,e),t=!1},d(e){dn(n,e)}}}function Qr(e){var t,n,r=e.i in e.turnBoundaries&&Yr(e);return{c(){r&&r.c(),t=Ot()},m(e,o){r&&r.m(e,o),bt(e,t,o),n=!0},p(e,n){n.i in n.turnBoundaries?r?(r.p(e,n),sn(r,1)):((r=Yr(n)).c(),sn(r,1),r.m(t.parentNode,t)):r&&(on(),cn(r,1,1,()=>{r=null}),an())},i(e){n||(sn(r),n=!0)},o(e){cn(r),n=!1},d(e){r&&r.d(e),e&&xt(t)}}}function Zr(e){var t,n=new $r({props:{pinned:e.i===e.pinned,logIndex:e.i,action:e.action,payload:e.payload}});return n.$on("click",e.OnLogClick),n.$on("mouseenter",e.OnMouseEnter),n.$on("mouseleave",e.OnMouseLeave),{c(){n.$$.fragment.c()},m(e,r){fn(n,e,r),t=!0},p(e,t){var r={};e.pinned&&(r.pinned=t.i===t.pinned),e.renderedLogEntries&&(r.action=t.action),e.renderedLogEntries&&(r.payload=t.payload),n.$set(r)},i(e){t||(sn(n.$$.fragment,e),t=!0)},o(e){cn(n.$$.fragment,e),t=!1},d(e){dn(n,e)}}}function eo(e){var t,n=new yr({props:{phase:e.phase,numEvents:e.phaseBoundaries[e.i]}});return{c(){n.$$.fragment.c()},m(e,r){fn(n,e,r),t=!0},p(e,t){var r={};e.renderedLogEntries&&(r.phase=t.phase),e.phaseBoundaries&&(r.numEvents=t.phaseBoundaries[t.i]),n.$set(r)},i(e){t||(sn(n.$$.fragment,e),t=!0)},o(e){cn(n.$$.fragment,e),t=!1},d(e){dn(n,e)}}}function to(e){var t,n,r=e.i in e.phaseBoundaries&&eo(e);return{c(){r&&r.c(),t=Ot()},m(e,o){r&&r.m(e,o),bt(e,t,o),n=!0},p(e,n){n.i in n.phaseBoundaries?r?(r.p(e,n),sn(r,1)):((r=eo(n)).c(),sn(r,1),r.m(t.parentNode,t)):r&&(on(),cn(r,1,1,()=>{r=null}),an())},i(e){n||(sn(r),n=!0)},o(e){cn(r),n=!1},d(e){r&&r.d(e),e&&xt(t)}}}function no(e){var t,n,r,o,i;let a=e.renderedLogEntries,s=[];for(let t=0;t<a.length;t+=1)s[t]=Qr(Xr(e,a,t));const c=e=>cn(s[e],1,1,()=>{s[e]=null});let l=e.renderedLogEntries,u=[];for(let t=0;t<l.length;t+=1)u[t]=Zr(Jr(e,l,t));const p=e=>cn(u[e],1,1,()=>{u[e]=null});let f=e.renderedLogEntries,d=[];for(let t=0;t<f.length;t+=1)d[t]=to(Wr(e,f,t));const h=e=>cn(d[e],1,1,()=>{d[e]=null});return{c(){t=kt("div");for(let e=0;e<s.length;e+=1)s[e].c();n=Ct();for(let e=0;e<u.length;e+=1)u[e].c();r=Ct();for(let e=0;e<d.length;e+=1)d[e].c();Dt(t,"class","gamelog svelte-1pq5e4b"),St(t,"pinned",e.pinned),i=It(window,"keydown",e.OnKeyDown)},m(e,i){bt(e,t,i);for(let e=0;e<s.length;e+=1)s[e].m(t,null);gt(t,n);for(let e=0;e<u.length;e+=1)u[e].m(t,null);gt(t,r);for(let e=0;e<d.length;e+=1)d[e].m(t,null);o=!0},p(e,o){if(e.turnBoundaries||e.renderedLogEntries){let r;for(a=o.renderedLogEntries,r=0;r<a.length;r+=1){const i=Xr(o,a,r);s[r]?(s[r].p(e,i),sn(s[r],1)):(s[r]=Qr(i),s[r].c(),sn(s[r],1),s[r].m(t,n))}for(on(),r=a.length;r<s.length;r+=1)c(r);an()}if(e.pinned||e.renderedLogEntries){let n;for(l=o.renderedLogEntries,n=0;n<l.length;n+=1){const i=Jr(o,l,n);u[n]?(u[n].p(e,i),sn(u[n],1)):(u[n]=Zr(i),u[n].c(),sn(u[n],1),u[n].m(t,r))}for(on(),n=l.length;n<u.length;n+=1)p(n);an()}if(e.phaseBoundaries||e.renderedLogEntries){let n;for(f=o.renderedLogEntries,n=0;n<f.length;n+=1){const r=Wr(o,f,n);d[n]?(d[n].p(e,r),sn(d[n],1)):(d[n]=to(r),d[n].c(),sn(d[n],1),d[n].m(t,null))}for(on(),n=f.length;n<d.length;n+=1)h(n);an()}e.pinned&&St(t,"pinned",o.pinned)},i(e){if(!o){for(let e=0;e<a.length;e+=1)sn(s[e]);for(let e=0;e<l.length;e+=1)sn(u[e]);for(let e=0;e<f.length;e+=1)sn(d[e]);o=!0}},o(e){s=s.filter(Boolean);for(let e=0;e<s.length;e+=1)cn(s[e]);u=u.filter(Boolean);for(let e=0;e<u.length;e+=1)cn(u[e]);d=d.filter(Boolean);for(let e=0;e<d.length;e+=1)cn(d[e]);o=!1},d(e){e&&xt(t),wt(s,e),wt(u,e),wt(d,e),i()}}}function ro(e,t,n){let r,{client:o}=t;ct(e,o,e=>{n("$client",r=e)});const{secondaryPane:i}=Gt("secondaryPane");let a,{log:s,_initial:c}=r,l=null;function u(e){let t=c;for(let n=0;n<s.length;n++){const{action:r,automatic:i}=s[n];if(i||(t=o.reducer(t,r)),r.type==O){if(0==e)break;e--}}return{G:t.G,ctx:t.ctx}}function p(){n("pinned",l=null),o.overrideGameState(null),i.set(null)}zt(p);let f={},d={};return e.$set=(e=>{"client"in e&&n("client",o=e.client)}),e.$$.update=((e={$client:1,log:1,renderedLogEntries:1})=>{if(e.$client||e.log||e.renderedLogEntries){n("log",s=r.log),n("renderedLogEntries",a=s.filter(e=>e.action.type==O));let e=0,t=0;n("turnBoundaries",f={}),n("phaseBoundaries",d={});for(let r=0;r<a.length;r++){const{action:o,payload:i,turn:s,phase:c}=a[r];t++,e++,r!=a.length-1&&a[r+1].turn==s||(n("turnBoundaries",f[r]=t,f),t=0),r!=a.length-1&&a[r+1].phase==c||(n("phaseBoundaries",d[r]=e,d),e=0)}}}),{client:o,pinned:l,OnLogClick:function(e){const{logIndex:t}=e.detail,r=u(t),a=s.filter(e=>e.action.type==O);if(o.overrideGameState(r),l==t)n("pinned",l=null),i.set(null);else{n("pinned",l=t);const{metadata:e}=a[t].action.payload;e&&i.set({component:Vr,metadata:e})}},OnMouseEnter:function(e){const{logIndex:t}=e.detail;if(null===l){const e=u(t);o.overrideGameState(e)}},OnMouseLeave:function(){null===l&&o.overrideGameState(null)},OnKeyDown:function(e){27==e.keyCode&&p()},renderedLogEntries:a,turnBoundaries:f,phaseBoundaries:d}}class oo extends vn{constructor(e){var t;super(),document.getElementById("svelte-1pq5e4b-style")||((t=kt("style")).id="svelte-1pq5e4b-style",t.textContent=".gamelog.svelte-1pq5e4b{display:grid;grid-template-columns:30px 1fr 30px;grid-auto-rows:auto;grid-auto-flow:column}",gt(document.head,t)),yn(this,e,ro,no,st,["client"])}}const{Object:io}=pn;function ao(e,t,n){const r=io.create(e);return r.key=t[n][0],r.value=t[n][1],r}function so(e){var t,n,r,o,i,a,s,c=e.values[e.key]+"";function l(){e.input_change_input_handler.call(o,e)}return{c(){t=kt("span"),n=Pt(c),r=Ct(),o=kt("input"),Dt(t,"class","value svelte-7cel4i"),Dt(o,"type","range"),Dt(o,"min",i=e.value.range.min),Dt(o,"max",a=e.value.range.max),s=[It(o,"change",l),It(o,"input",l),It(o,"change",e.OnChange)]},m(i,a){bt(i,t,a),gt(t,n),bt(i,r,a),bt(i,o,a),_t(o,e.values[e.key])},p(t,r){e=r,(t.values||t.bot)&&c!==(c=e.values[e.key]+"")&&At(n,c),(t.values||t.Object||t.bot)&&_t(o,e.values[e.key]),t.bot&&i!==(i=e.value.range.min)&&Dt(o,"min",i),t.bot&&a!==(a=e.value.range.max)&&Dt(o,"max",a)},d(e){e&&(xt(t),xt(r),xt(o)),it(s)}}}function co(e){var t,n;function r(){e.input_change_handler.call(t,e)}return{c(){Dt(t=kt("input"),"type","checkbox"),Dt(t,"class","svelte-7cel4i"),n=[It(t,"change",r),It(t,"change",e.OnChange)]},m(n,r){bt(n,t,r),t.checked=e.values[e.key]},p(n,r){e=r,(n.values||n.Object||n.bot)&&(t.checked=e.values[e.key])},d(e){e&&xt(t),it(n)}}}function lo(e){var t,n,r,o,i,a,s=e.key+"",c=e.value.range&&so(e),l="boolean"==typeof e.value.value&&co(e);return{c(){t=kt("div"),n=kt("label"),r=Pt(s),o=Ct(),c&&c.c(),i=Ct(),l&&l.c(),a=Ct(),Dt(n,"class","svelte-7cel4i"),Dt(t,"class","option svelte-7cel4i")},m(e,s){bt(e,t,s),gt(t,n),gt(n,r),gt(t,o),c&&c.m(t,null),gt(t,i),l&&l.m(t,null),gt(t,a)},p(e,n){e.bot&&s!==(s=n.key+"")&&At(r,s),n.value.range?c?c.p(e,n):((c=so(n)).c(),c.m(t,i)):c&&(c.d(1),c=null),"boolean"==typeof n.value.value?l?l.p(e,n):((l=co(n)).c(),l.m(t,a)):l&&(l.d(1),l=null)},d(e){e&&xt(t),c&&c.d(),l&&l.d()}}}function uo(e){var t;let n=e.Object.entries(e.bot.opts()),r=[];for(let t=0;t<n.length;t+=1)r[t]=lo(ao(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=Ot()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);bt(e,t,n)},p(e,o){if(e.Object||e.bot||e.values){let i;for(n=o.Object.entries(o.bot.opts()),i=0;i<n.length;i+=1){const a=ao(o,n,i);r[i]?r[i].p(e,a):(r[i]=lo(a),r[i].c(),r[i].m(t.parentNode,t))}for(;i<r.length;i+=1)r[i].d(1);r.length=n.length}},i:et,o:et,d(e){wt(r,e),e&&xt(t)}}}function po(e,t,n){let{bot:r}=t,o={};for(let[e,t]of Object.entries(r.opts()))n("values",o[e]=t.value,o);return e.$set=(e=>{"bot"in e&&n("bot",r=e.bot)}),{bot:r,values:o,OnChange:function(){for(let[e,t]of Object.entries(o))r.setOpt(e,t)},Object:Object,input_change_input_handler:function({key:e}){var t;o[e]=""===(t=this.value)?void 0:+t,n("values",o),n("Object",Object),n("bot",r)},input_change_handler:function({key:e}){o[e]=this.checked,n("values",o),n("Object",Object),n("bot",r)}}}class fo extends vn{constructor(e){var t;super(),document.getElementById("svelte-7cel4i-style")||((t=kt("style")).id="svelte-7cel4i-style",t.textContent="label.svelte-7cel4i{font-weight:bold;color:#999}.option.svelte-7cel4i{margin-bottom:20px}.value.svelte-7cel4i{font-weight:bold}input[type='checkbox'].svelte-7cel4i{vertical-align:middle}",gt(document.head,t)),yn(this,e,po,uo,st,["bot"])}}var ho=function(e,t,n){return!1!==n.undoable&&(!(n.undoable instanceof Function)||n.undoable(e,t))},yo="INVALID_MOVE";function vo(e){var t=e.game,n=e.multiplayer;return t=Ze(t),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;switch(r.type){case I:if(e=c({},e,{deltalog:[]}),n)return e;if(void 0!==e.ctx.gameover)return Re("cannot call event after game end"),e;if(null!==r.payload.playerID&&void 0!==r.payload.playerID&&!t.flow.isPlayerActive(e.G,e.ctx,r.payload.playerID))return Re("disallowed event: ".concat(r.payload.type)),e;var o=new Ye(e.ctx,t,r.payload.playerID);e.ctx=o.attachToContext(e.ctx),e=je(e,t.plugins);var i=t.flow.processEvent(e,r);return i=o.updateAndDetach(i,!0),c({},i=Ne(i,t.plugins),{_stateID:e._stateID+1});case O:e=c({},e,{deltalog:[]});var a=t.flow.getMove(e.ctx,r.payload.type,r.payload.playerID||e.ctx.currentPlayer);if(null===a)return Re("disallowed move: ".concat(r.payload.type)),e;if(n&&!1===a.client)return e;if(void 0!==e.ctx.gameover)return Re("cannot make move after game end"),e;if(null!==r.payload.playerID&&void 0!==r.payload.playerID&&!t.flow.isPlayerActive(e.G,e.ctx,r.payload.playerID))return Re("disallowed move: ".concat(r.payload.type)),e;var s=new Ye(e.ctx,t,r.payload.playerID),l=s.attachToContext(e.ctx);e=Se(e,t.plugins);var u=t.processMove(e.G,r.payload,l);if(u===yo)return Re("invalid move: ".concat(r.payload.type," args: ").concat(r.payload.args)),e;var p={action:r,_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};!0===a.redact&&(p.redact=!0);var f=s.updateAndDetach(c({},e,{deltalog:[p]}),!1),d=f.ctx;return n&&void 0!==d._random&&void 0!==d._random.prngstate?e:(e=c({},f,{G:u,ctx:d,_stateID:e._stateID+1}),e=Be(e,t.plugins),n?e:(l=s.attachToContext(e.ctx),e=t.flow.processMove(c({},e,{ctx:l}),r.payload),e=s.updateAndDetach(e,!0)));case A:case S:case _:return r.state;case E:var y=e,v=y._undo,m=y._redo;if(v.length<2)return e;var g=v[v.length-1],b=v[v.length-2],x=t.flow.getMove(e.ctx,g.moveType,e.ctx.currentPlayer);return ho(e.G,e.ctx,x)?c({},e,{G:b.G,ctx:b.ctx,_undo:v.slice(0,v.length-1),_redo:[g].concat(h(m))}):e;case D:var w=e,k=w._undo,$=w._redo;if(0==$.length)return e;var P=$[0];return c({},e,{G:P.G,ctx:P.ctx,_undo:[].concat(h(k),[P]),_redo:$.slice(1)});default:return e}}}var mo=function(){function e(t){var n=this,o=t.enumerate,i=t.seed;r(this,e),a(this,"enumerate",function(e,t,r){return n.enumerateFn(e,t,r).map(function(e){return void 0!==e.payload?e:void 0!==e.move?j(e.move,e.args,r):void 0!==e.event?B(e.event,e.args,r):void 0})}),this.enumerateFn=o,this.seed=i,this.iterationCounter=0,this._opts={}}return i(e,[{key:"addOpt",value:function(e){var t=e.key,n=e.range,r=e.initial;this._opts[t]={range:n,value:r}}},{key:"getOpt",value:function(e){return this._opts[e].value}},{key:"setOpt",value:function(e,t){e in this._opts&&(this._opts[e].value=t)}},{key:"opts",value:function(){return this._opts}},{key:"random",value:function(e){var t;if(void 0!==this.seed){var n=null;t=(n=this.prngstate?new Ve("",{state:this.prngstate}):new Ve(this.seed,{state:!0}))(),this.prngstate=n.state()}else t=Math.random();return e?e.length?e[Math.floor(t*e.length)]:Math.floor(t*e):t}}]),e}(),go=function(e){function t(e){var n,o=e.enumerate,i=e.seed,a=e.objectives,s=e.game,c=e.iterations,l=e.playoutDepth,p=e.iterationCallback;return r(this,t),void 0===a&&(a=function(){return{}}),(n=d(this,u(t).call(this,{enumerate:o,seed:i}))).objectives=a,n.iterationCallback=p||function(){},n.reducer=vo({game:s}),n.iterations=c,n.playoutDepth=l,n.addOpt({key:"async",initial:!1}),n.addOpt({key:"iterations",initial:"number"==typeof c?c:1e3,range:{min:1,max:2e3}}),n.addOpt({key:"playoutDepth",initial:"number"==typeof l?l:50,range:{min:1,max:100}}),n}return l(t,mo),i(t,[{key:"createNode",value:function(e){var t=e.state,n=e.parentAction,r=e.parent,o=e.playerID,i=t.G,a=t.ctx,s=[],c=[];if(void 0!==o)s=this.enumerate(i,a,o),c=this.objectives(i,a,o);else if(a.activePlayers)for(var l in a.activePlayers)s=s.concat(this.enumerate(i,a,l)),c=c.concat(this.objectives(i,a,l));else s=s.concat(this.enumerate(i,a,a.currentPlayer)),c=c.concat(this.objectives(i,a,a.currentPlayer));return{state:t,parent:r,parentAction:n,actions:s,objectives:c,children:[],visits:0,value:0}}},{key:"select",value:function(e){if(e.actions.length>0)return e;if(0==e.children.length)return e;var t=null,n=0,r=!0,o=!1,i=void 0;try{for(var a,s=e.children[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var c=a.value,l=c.visits+Number.EPSILON,u=c.value/l+Math.sqrt(2*Math.log(e.visits)/l);(null==t||u>n)&&(n=u,t=c)}}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return this.select(t)}},{key:"expand",value:function(e){var t=e.actions;if(0==t.length||void 0!==e.state.ctx.gameover)return e;var n=this.random(t.length),r=t[n];e.actions.splice(n,1);var o=this.reducer(e.state,r),i=this.createNode({state:o,parentAction:r,parent:e});return e.children.push(i),i}},{key:"playout",value:function(e){var t=this,r=e.state,o=this.getOpt("playoutDepth");"function"==typeof this.playoutDepth&&(o=this.playoutDepth(r.G,r.ctx));for(var i=function(e){var n=r,o=n.G,i=n.ctx,a=i.currentPlayer;i.activePlayers&&(a=Object.keys(i.activePlayers)[0]);var s=t.enumerate(o,i,a),c=t.objectives(o,i),l=Object.keys(c).reduce(function(e,t){var n=c[t];return n.checker(o,i)?e+n.weight:e},0);if(l>0)return{v:{score:l}};if(!s||0==s.length)return{v:void 0};var u=t.random(s.length),p=t.reducer(r,s[u]);r=p},a=0;a<o&&void 0===r.ctx.gameover;a++){var s=i();if("object"===n(s))return s.v}return r.ctx.gameover}},{key:"backpropagate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.visits++,void 0!==t.score&&(e.value+=t.score),!0===t.draw&&(e.value+=.5),e.parentAction&&t.winner===e.parentAction.payload.playerID&&e.value++,e.parent&&this.backpropagate(e.parent,t)}},{key:"play",value:function(e,t){var n=this,r=this.createNode({state:e,playerID:t}),o=this.getOpt("iterations");"function"==typeof this.iterations&&(o=this.iterations(e.G,e.ctx));var i=function(){var e=null,t=!0,n=!1,o=void 0;try{for(var i,a=r.children[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;(null==e||s.visits>e.visits)&&(e=s)}}catch(e){n=!0,o=e}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}return{action:e&&e.parentAction,metadata:r}};return new Promise(function(e){var t=function(){for(var e=0;e<25&&n.iterationCounter<o;e++){var t=n.select(r),i=n.expand(t),a=n.playout(i);n.backpropagate(i,a),n.iterationCounter++}n.iterationCallback({iterationCounter:n.iterationCounter,numIterations:o,metadata:r})};if(n.iterationCounter=0,n.getOpt("async")){!function r(){n.iterationCounter<o?(t(),setTimeout(r,0)):e(i())}()}else{for(;n.iterationCounter<o;)t();e(i())}})}}]),t}(),bo=function(e){function t(){return r(this,t),d(this,u(t).apply(this,arguments))}return l(t,mo),i(t,[{key:"play",value:function(e,t){var n=e.G,r=e.ctx,o=this.enumerate(n,r,t);return Promise.resolve({action:this.random(o)})}}]),t}();async function xo(e,t){var n=e.store.getState(),r=n.ctx.currentPlayer;n.ctx.activePlayers&&(r=Object.keys(n.ctx.activePlayers)[0]);var o=await t.play(n,r),i=o.action,a=o.metadata;return i&&(i.payload.metadata=a,e.store.dispatch(i)),i}function wo(e,t,n){const r=Object.create(e);return r.bot=t[n],r}function ko(e){var t,n,r;return{c(){(t=kt("p")).textContent="No bots available.",n=Ct(),(r=kt("p")).innerHTML='\n\t\t\t        Follow the instructions\n\t\t\t        <a href="https://boardgame.io/documentation/#/tutorial?id=bots" target="_blank">\n\t\t\t          here</a>\n\t\t\t        to set up bots.\n\t\t\t      '},m(e,o){bt(e,t,o),bt(e,n,o),bt(e,r,o)},p:et,i:et,o:et,d(e){e&&(xt(t),xt(n),xt(r))}}}function $o(e){var t;return{c(){(t=kt("p")).textContent="The bot debugger is only available in singleplayer mode."},m(e,n){bt(e,t,n)},p:et,i:et,o:et,d(e){e&&xt(t)}}}function Po(e){var t,n,r,o,i,a,s,c,l,u,p,f,d,h,y,v,m,g,b=Object.keys(e.bot.opts()).length,x=new An({props:{value:"1",onPress:e.Reset,label:"reset"}}),w=new An({props:{value:"2",onPress:e.Step,label:"play"}}),k=new An({props:{value:"3",onPress:e.Simulate,label:"simulate"}});let $=Object.keys(e.bots),P=[];for(let t=0;t<$.length;t+=1)P[t]=Co(wo(e,$,t));var C=b&&Oo(e),O=(e.botAction||e.iterationCounter)&&Io(e);return{c(){t=kt("section"),(n=kt("h3")).textContent="Controls",r=Ct(),o=kt("li"),x.$$.fragment.c(),i=Ct(),a=kt("li"),w.$$.fragment.c(),s=Ct(),c=kt("li"),k.$$.fragment.c(),l=Ct(),u=kt("section"),(p=kt("h3")).textContent="Bot",f=Ct(),d=kt("select");for(let e=0;e<P.length;e+=1)P[e].c();h=Ct(),C&&C.c(),y=Ct(),O&&O.c(),v=Ot(),Dt(n,"class","svelte-hsd9fq"),Dt(o,"class","svelte-hsd9fq"),Dt(a,"class","svelte-hsd9fq"),Dt(c,"class","svelte-hsd9fq"),Dt(p,"class","svelte-hsd9fq"),void 0===e.selectedBot&&Qt(()=>e.select_change_handler.call(d)),g=[It(d,"change",e.select_change_handler),It(d,"change",e.ChangeBot)]},m(g,b){bt(g,t,b),gt(t,n),gt(t,r),gt(t,o),fn(x,o,null),gt(t,i),gt(t,a),fn(w,a,null),gt(t,s),gt(t,c),fn(k,c,null),bt(g,l,b),bt(g,u,b),gt(u,p),gt(u,f),gt(u,d);for(let e=0;e<P.length;e+=1)P[e].m(d,null);Et(d,e.selectedBot),bt(g,h,b),C&&C.m(g,b),bt(g,y,b),O&&O.m(g,b),bt(g,v,b),m=!0},p(e,t){if(e.bots){let n;for($=Object.keys(t.bots),n=0;n<$.length;n+=1){const r=wo(t,$,n);P[n]?P[n].p(e,r):(P[n]=Co(r),P[n].c(),P[n].m(d,null))}for(;n<P.length;n+=1)P[n].d(1);P.length=$.length}e.selectedBot&&Et(d,t.selectedBot),e.bot&&(b=Object.keys(t.bot.opts()).length),b?C?(C.p(e,t),sn(C,1)):((C=Oo(t)).c(),sn(C,1),C.m(y.parentNode,y)):C&&(on(),cn(C,1,1,()=>{C=null}),an()),t.botAction||t.iterationCounter?O?O.p(e,t):((O=Io(t)).c(),O.m(v.parentNode,v)):O&&(O.d(1),O=null)},i(e){m||(sn(x.$$.fragment,e),sn(w.$$.fragment,e),sn(k.$$.fragment,e),sn(C),m=!0)},o(e){cn(x.$$.fragment,e),cn(w.$$.fragment,e),cn(k.$$.fragment,e),cn(C),m=!1},d(e){e&&xt(t),dn(x),dn(w),dn(k),e&&(xt(l),xt(u)),wt(P,e),e&&xt(h),C&&C.d(e),e&&xt(y),O&&O.d(e),e&&xt(v),it(g)}}}function Co(e){var t,n,r=e.bot+"";return{c(){t=kt("option"),n=Pt(r),t.__value=e.bot,t.value=t.__value},m(e,r){bt(e,t,r),gt(t,n)},p:et,d(e){e&&xt(t)}}}function Oo(e){var t,n,r,o,i,a,s,c,l,u=new fo({props:{bot:e.bot}});return{c(){t=kt("section"),(n=kt("h3")).textContent="Options",r=Ct(),(o=kt("label")).textContent="debug",i=Ct(),a=kt("input"),s=Ct(),u.$$.fragment.c(),Dt(n,"class","svelte-hsd9fq"),Dt(o,"class","svelte-hsd9fq"),Dt(a,"type","checkbox"),Dt(a,"class","svelte-hsd9fq"),l=[It(a,"change",e.input_change_handler),It(a,"change",e.OnDebug)]},m(l,p){bt(l,t,p),gt(t,n),gt(t,r),gt(t,o),gt(t,i),gt(t,a),a.checked=e.debug,gt(t,s),fn(u,t,null),c=!0},p(e,t){e.debug&&(a.checked=t.debug);var n={};e.bot&&(n.bot=t.bot),u.$set(n)},i(e){c||(sn(u.$$.fragment,e),c=!0)},o(e){cn(u.$$.fragment,e),c=!1},d(e){e&&xt(t),dn(u),it(l)}}}function Io(e){var t,n,r,o,i=e.progress&&e.progress<1&&Do(e),a=e.botAction&&Ao(e);return{c(){t=kt("section"),(n=kt("h3")).textContent="Result",r=Ct(),i&&i.c(),o=Ct(),a&&a.c(),Dt(n,"class","svelte-hsd9fq")},m(e,s){bt(e,t,s),gt(t,n),gt(t,r),i&&i.m(t,null),gt(t,o),a&&a.m(t,null)},p(e,n){n.progress&&n.progress<1?i?i.p(e,n):((i=Do(n)).c(),i.m(t,o)):i&&(i.d(1),i=null),n.botAction?a?a.p(e,n):((a=Ao(n)).c(),a.m(t,null)):a&&(a.d(1),a=null)},d(e){e&&xt(t),i&&i.d(),a&&a.d()}}}function Do(e){var t;return{c(){(t=kt("progress")).value=e.progress},m(e,n){bt(e,t,n)},p(e,n){e.progress&&(t.value=n.progress)},d(e){e&&xt(t)}}}function Ao(e){var t,n,r,o,i,a,s,c=JSON.stringify(e.botActionArgs)+"";return{c(){t=kt("li"),n=Pt("Action: "),r=Pt(e.botAction),o=Ct(),i=kt("li"),a=Pt("Args: "),s=Pt(c),Dt(t,"class","svelte-hsd9fq"),Dt(i,"class","svelte-hsd9fq")},m(e,c){bt(e,t,c),gt(t,n),gt(t,r),bt(e,o,c),bt(e,i,c),gt(i,a),gt(i,s)},p(e,t){e.botAction&&At(r,t.botAction),e.botActionArgs&&c!==(c=JSON.stringify(t.botActionArgs)+"")&&At(s,c)},d(e){e&&(xt(t),xt(o),xt(i))}}}function _o(e){var t,n,r,o,i,a=[Po,$o,ko],s=[];function c(e,t){return t.client.game.ai&&!t.client.multiplayer?0:t.client.multiplayer?1:2}return n=c(0,e),r=s[n]=a[n](e),{c(){t=kt("section"),r.c(),i=It(window,"keydown",e.OnKeyDown)},m(e,r){bt(e,t,r),s[n].m(t,null),o=!0},p(e,o){var i=n;(n=c(0,o))===i?s[n].p(e,o):(on(),cn(s[i],1,1,()=>{s[i]=null}),an(),(r=s[n])||(r=s[n]=a[n](o)).c(),sn(r,1),r.m(t,null))},i(e){o||(sn(r),o=!0)},o(e){cn(r),o=!1},d(e){e&&xt(t),s[n].d(),i()}}}function Eo(e,t,n){let{client:r}=t;const{secondaryPane:o}=Gt("secondaryPane"),i={MCTS:go,Random:bo};let a=!1,s=null,c=0,l=null;const u=({iterationCounter:e,numIterations:t,metadata:r})=>{n("iterationCounter",c=e),n("progress",s=e/t),l=r,a&&l&&o.set({component:Vr,metadata:l})};let p,f,d,h;function y(){r.overrideGameState(null),o.set(null),n("debug",a=!1)}return r.game.ai&&(n("bot",p=new go({game:r.game,enumerate:r.game.ai.enumerate,iterationCallback:u})),p.setOpt("async",!0)),zt(y),e.$set=(e=>{"client"in e&&n("client",r=e.client)}),{client:r,bots:i,debug:a,progress:s,iterationCounter:c,OnDebug:function(){a&&l?o.set({component:Vr,metadata:l}):o.set(null)},bot:p,selectedBot:f,botAction:d,botActionArgs:h,ChangeBot:function(){const e=i[f];n("bot",p=new e({game:r.game,enumerate:r.game.ai.enumerate,iterationCallback:u})),p.setOpt("async",!0),n("botAction",d=null),l=null,o.set(null),n("iterationCounter",c=0)},Step:async function(){n("botAction",d=null),l=null,n("iterationCounter",c=0);const e=await xo(r,p);e&&(n("botAction",d=e.payload.type),n("botActionArgs",h=e.payload.args))},Simulate:function(e=1e4,t=100){return n("botAction",d=null),l=null,n("iterationCounter",c=0),(async()=>{for(let n=0;n<e&&await xo(r,p);n++)await new Promise(e=>setTimeout(e,t))})()},Reset:function(){r.reset(),n("botAction",d=null),l=null,n("iterationCounter",c=0),y()},OnKeyDown:function(e){27==e.keyCode&&y()},select_change_handler:function(){f=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n("selectedBot",f),n("bots",i)},input_change_handler:function(){a=this.checked,n("debug",a)}}}class So extends vn{constructor(e){var t;super(),document.getElementById("svelte-hsd9fq-style")||((t=kt("style")).id="svelte-hsd9fq-style",t.textContent="li.svelte-hsd9fq{list-style:none;margin:none;margin-bottom:5px}h3.svelte-hsd9fq{text-transform:uppercase}label.svelte-hsd9fq{font-weight:bold;color:#999}input[type='checkbox'].svelte-hsd9fq{vertical-align:middle}",gt(document.head,t)),yn(this,e,Eo,_o,st,["client"])}}function jo(e){var t,n,r,o,i,a,s=new Cn({props:{panes:e.panes,pane:e.pane}});s.$on("change",e.MenuChange);var c=e.panes[e.pane].component;function l(e){return{props:{client:e.client}}}if(c)var u=new c(l(e));var p=e.$secondaryPane&&Bo(e);return{c(){t=kt("div"),s.$$.fragment.c(),n=Ct(),r=kt("div"),u&&u.$$.fragment.c(),o=Ct(),p&&p.c(),Dt(r,"class","pane svelte-1h5kecx"),Dt(t,"class","debug-panel svelte-1h5kecx")},m(e,i){bt(e,t,i),fn(s,t,null),gt(t,n),gt(t,r),u&&fn(u,r,null),gt(t,o),p&&p.m(t,null),a=!0},p(e,n){var o={};e.pane&&(o.pane=n.pane),s.$set(o);var i={};if(e.client&&(i.client=n.client),c!==(c=n.panes[n.pane].component)){if(u){on();const e=u;cn(e.$$.fragment,1,0,()=>{dn(e,1)}),an()}c?((u=new c(l(n))).$$.fragment.c(),sn(u.$$.fragment,1),fn(u,r,null)):u=null}else c&&u.$set(i);n.$secondaryPane?p?(p.p(e,n),sn(p,1)):((p=Bo(n)).c(),sn(p,1),p.m(t,null)):p&&(on(),cn(p,1,1,()=>{p=null}),an())},i(e){a||(sn(s.$$.fragment,e),u&&sn(u.$$.fragment,e),sn(p),Qt(()=>{i||(i=un(t,xn,{x:400},!0)),i.run(1)}),a=!0)},o(e){cn(s.$$.fragment,e),u&&cn(u.$$.fragment,e),cn(p),i||(i=un(t,xn,{x:400},!1)),i.run(0),a=!1},d(e){e&&xt(t),dn(s),u&&dn(u),p&&p.d(),e&&i&&i.end()}}}function Bo(e){var t,n,r=e.$secondaryPane.component;function o(e){return{props:{metadata:e.$secondaryPane.metadata}}}if(r)var i=new r(o(e));return{c(){t=kt("div"),i&&i.$$.fragment.c(),Dt(t,"class","secondary-pane svelte-1h5kecx")},m(e,r){bt(e,t,r),i&&fn(i,t,null),n=!0},p(e,n){var a={};if(e.$secondaryPane&&(a.metadata=n.$secondaryPane.metadata),r!==(r=n.$secondaryPane.component)){if(i){on();const e=i;cn(e.$$.fragment,1,0,()=>{dn(e,1)}),an()}r?((i=new r(o(n))).$$.fragment.c(),sn(i.$$.fragment,1),fn(i,t,null)):i=null}else r&&i.$set(a)},i(e){n||(i&&sn(i.$$.fragment,e),n=!0)},o(e){i&&cn(i.$$.fragment,e),n=!1},d(e){e&&xt(t),i&&dn(i)}}}function No(e){var t,n,r,o=e.visible&&jo(e);return{c(){o&&o.c(),t=Ot(),r=It(window,"keypress",e.Keypress)},m(e,r){o&&o.m(e,r),bt(e,t,r),n=!0},p(e,n){n.visible?o?(o.p(e,n),sn(o,1)):((o=jo(n)).c(),sn(o,1),o.m(t.parentNode,t)):o&&(on(),cn(o,1,1,()=>{o=null}),an())},i(e){n||(sn(o),n=!0)},o(e){cn(o),n=!1},d(e){o&&o.d(e),e&&xt(t),r()}}}function Mo(e,t,n){let r,{client:o}=t;const i={main:{label:"Main",shortcut:"m",component:nr},log:{label:"Log",shortcut:"l",component:oo},info:{label:"Info",shortcut:"i",component:lr},ai:{label:"AI",shortcut:"a",component:So}},a=gn(!1),s=gn(null);ct(e,s,e=>{n("$secondaryPane",r=e)}),Ut("hotkeys",{disableHotkeys:a}),Ut("secondaryPane",{secondaryPane:s});let c="main";let l=!0;return e.$set=(e=>{"client"in e&&n("client",o=e.client)}),{client:o,panes:i,secondaryPane:s,pane:c,MenuChange:function(e){n("pane",c=e.detail)},visible:l,Keypress:function(e){"."!=e.key?Object.entries(i).forEach(([t,{shortcut:r}])=>{e.key==r&&n("pane",c=t)}):n("visible",l=!l)},$secondaryPane:r}}class To extends vn{constructor(e){var t;super(),document.getElementById("svelte-1h5kecx-style")||((t=kt("style")).id="svelte-1h5kecx-style",t.textContent=".debug-panel.svelte-1h5kecx{position:fixed;color:#555;font-family:monospace;display:flex;flex-direction:row;text-align:left;right:0;top:0;height:100%;font-size:14px;box-sizing:border-box;opacity:0.9}.pane.svelte-1h5kecx{flex-grow:2;overflow-x:hidden;overflow-y:scroll;background:#fefefe;padding:20px;border-left:1px solid #ccc;box-shadow:-1px 0 5px rgba(0, 0, 0, 0.2);box-sizing:border-box;width:280px}.secondary-pane.svelte-1h5kecx{background:#fefefe;overflow-y:scroll}.debug-panel.svelte-1h5kecx button, select{cursor:pointer;outline:none;background:#eee;border:1px solid #bbb;color:#555;padding:3px;border-radius:3px}.debug-panel.svelte-1h5kecx button{padding-left:10px;padding-right:10px}.debug-panel.svelte-1h5kecx button:hover{background:#ddd}.debug-panel.svelte-1h5kecx button:active{background:#888;color:#fff}.debug-panel.svelte-1h5kecx section{margin-bottom:20px}",gt(document.head,t)),yn(this,e,Mo,No,st,["client"])}}function Ro(e){var t=e.game,n=e.numPlayers,r=e.setupData;n||(n=2);var o=(t=Ze(t)).flow.ctx(n),i=t.seed;void 0===i&&(i=We.seed()),o._random={seed:i},o=_e.ctx(o,t);var a=new Ye(o,t,o.currentPlayer),s=a.attachToContext(o),c=t.setup(s,r),l={G:c=_e.G(c,s,t),ctx:o,_undo:[],_redo:[],_stateID:0,_initial:{}},u=t.flow.init({G:l.G,ctx:s});l.G=u.G,l._undo=u._undo,u=a.updateAndDetach(u,!0),l.ctx=u.ctx;return l._initial=Rn(qn(l)),l}function qo(e,t,n,r,o,i){return t.reduce(function(t,a){return t[a]=function(){var t=r;i||null!=r||(t=n.getState().ctx.currentPlayer);for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];n.dispatch(z[e](a,c,t,o))},t},{})}var Lo=qo.bind(null,"gameEvent"),zo=qo.bind(null,"makeMove"),Fo=function(){function e(t){var n=this,o=t.game,i=t.debug,a=t.numPlayers,s=t.multiplayer,c=t.gameID,l=t.playerID,u=t.credentials,p=t.enhancer;r(this,e),this.game=Ze(o),this.playerID=l,this.gameID=c,this.credentials=u,this.multiplayer=s,this.debug=i,this.gameStateOverride=null,this.subscribers={},this._running=!1,this.reducer=vo({game:this.game,numPlayers:a,multiplayer:s});var f=null;s||(f=Ro({game:this.game,numPlayers:a})),this.reset=function(){n.store.dispatch(R(f))},this.undo=function(){n.store.dispatch(q())},this.redo=function(){n.store.dispatch(L())},this.store=null,this.log=[];var d=function(e){return function(t){return function(r){var o=t(r),i=e.getState();switch(r.type){case O:case I:var a=i.deltalog;n.log=[].concat(h(n.log),h(a));break;case A:n.log=[];break;case S:var s=-1;n.log.length>0&&(s=n.log[n.log.length-1]._stateID);var c=r.deltalog||[];c=c.filter(function(e){return e._stateID>s}),n.log=[].concat(h(n.log),h(c));break;case _:n.log=r.log||[]}return o}}},y=function(e){return function(t){return function(r){var o=e.getState(),i=t(r);return 1!=r.clientOnly&&n.transport.onAction(o,r),i}}},v=function(){return function(e){return function(t){var r=e(t);return n.notifySubscribers(),r}}};p=void 0!==p?w(k(v,y,d),p):k(v,y,d),this.store=g(this.reducer,f,p),this.transport={isConnected:!0,onAction:function(){},subscribe:function(){},subscribeGameMetadata:function(e){},connect:function(){},disconnect:function(){},updateGameID:function(){},updatePlayerID:function(){}},s&&(this.transport=s({gameKey:o,game:this.game,store:this.store,gameID:c,playerID:l,gameName:this.game.name,numPlayers:a})),this.createDispatchers(),this.transport.subscribeGameMetadata(function(e){n.gameMetadata=e}),this._debugPanel=null}return i(e,[{key:"notifySubscribers",value:function(){var e=this;Object.values(this.subscribers).forEach(function(t){return t(e.getState())})}},{key:"overrideGameState",value:function(e){this.gameStateOverride=e,this.notifySubscribers()}},{key:"start",value:function(){this.transport.connect(),this._running=!0;var e=null;if(e=To,this.debug&&this.debug.impl&&(e=this.debug.impl),null!==e&&!1!==this.debug&&null==this._debugPanel){var t=document.body;this.debug&&this.debug.target&&(t=this.debug.target),this._debugPanel=new e({target:t,props:{client:this}})}}},{key:"stop",value:function(){this.transport.disconnect(),this._running=!1,null!=this._debugPanel&&(this._debugPanel.$destroy(),this._debugPanel=null)}},{key:"subscribe",value:function(e){var t=this,n=Object.keys(this.subscribers).length;return this.subscribers[n]=e,this.transport.subscribe(function(){return t.notifySubscribers()}),!this._running&&this.multiplayer||e(this.getState()),function(){delete t.subscribers[n]}}},{key:"getState",value:function(){var e=this.store.getState();if(null!==this.gameStateOverride&&(e=this.gameStateOverride),null===e)return e;var t=!0,n=this.game.flow.isPlayerActive(e.G,e.ctx,this.playerID);this.multiplayer&&!n&&(t=!1),this.multiplayer||null===this.playerID||void 0===this.playerID||n||(t=!1),void 0!==e.ctx.gameover&&(t=!1);var r=c({},e,{isActive:t,G:this.game.playerView(e.G,e.ctx,this.playerID),log:this.log});return r=c({},r,{isConnected:this.transport.isConnected})}},{key:"createDispatchers",value:function(){this.moves=zo(this.game.moveNames,this.store,this.playerID,this.credentials,this.multiplayer),this.events=Lo(this.game.flow.enabledEventNames,this.store,this.playerID,this.credentials,this.multiplayer)}},{key:"updatePlayerID",value:function(e){this.playerID=e,this.createDispatchers(),this.transport.updatePlayerID(e),this.notifySubscribers()}},{key:"updateGameID",value:function(e){this.gameID=e,this.createDispatchers(),this.transport.updateGameID(e),this.notifySubscribers()}},{key:"updateCredentials",value:function(e){this.credentials=e,this.createDispatchers(),this.notifySubscribers()}}]),e}();function Uo(e){return new Fo(e)}var Go="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Ho(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Ko(e,t){return e(t={exports:{}},t.exports),t.exports}var Vo=Ko(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,o=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,l=n?Symbol.for("react.context"):60110,u=n?Symbol.for("react.async_mode"):60111,p=n?Symbol.for("react.concurrent_mode"):60111,f=n?Symbol.for("react.forward_ref"):60112,d=n?Symbol.for("react.suspense"):60113,h=n?Symbol.for("react.suspense_list"):60120,y=n?Symbol.for("react.memo"):60115,v=n?Symbol.for("react.lazy"):60116,m=n?Symbol.for("react.fundamental"):60117,g=n?Symbol.for("react.responder"):60118;function b(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case u:case p:case i:case s:case a:case d:return e;default:switch(e=e&&e.$$typeof){case l:case f:case c:return e;default:return t}}case v:case y:case o:return t}}}function x(e){return b(e)===p}t.typeOf=b,t.AsyncMode=u,t.ConcurrentMode=p,t.ContextConsumer=l,t.ContextProvider=c,t.Element=r,t.ForwardRef=f,t.Fragment=i,t.Lazy=v,t.Memo=y,t.Portal=o,t.Profiler=s,t.StrictMode=a,t.Suspense=d,t.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===i||e===p||e===s||e===a||e===d||e===h||"object"==typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===y||e.$$typeof===c||e.$$typeof===l||e.$$typeof===f||e.$$typeof===m||e.$$typeof===g)},t.isAsyncMode=function(e){return x(e)||b(e)===u},t.isConcurrentMode=x,t.isContextConsumer=function(e){return b(e)===l},t.isContextProvider=function(e){return b(e)===c},t.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return b(e)===f},t.isFragment=function(e){return b(e)===i},t.isLazy=function(e){return b(e)===v},t.isMemo=function(e){return b(e)===y},t.isPortal=function(e){return b(e)===o},t.isProfiler=function(e){return b(e)===s},t.isStrictMode=function(e){return b(e)===a},t.isSuspense=function(e){return b(e)===d}});Ho(Vo);Vo.typeOf,Vo.AsyncMode,Vo.ConcurrentMode,Vo.ContextConsumer,Vo.ContextProvider,Vo.Element,Vo.ForwardRef,Vo.Fragment,Vo.Lazy,Vo.Memo,Vo.Portal,Vo.Profiler,Vo.StrictMode,Vo.Suspense,Vo.isValidElementType,Vo.isAsyncMode,Vo.isConcurrentMode,Vo.isContextConsumer,Vo.isContextProvider,Vo.isElement,Vo.isForwardRef,Vo.isFragment,Vo.isLazy,Vo.isMemo,Vo.isPortal,Vo.isProfiler,Vo.isStrictMode,Vo.isSuspense;var Wo=Ko(function(e,t){});Ho(Wo);Wo.typeOf,Wo.AsyncMode,Wo.ConcurrentMode,Wo.ContextConsumer,Wo.ContextProvider,Wo.Element,Wo.ForwardRef,Wo.Fragment,Wo.Lazy,Wo.Memo,Wo.Portal,Wo.Profiler,Wo.StrictMode,Wo.Suspense,Wo.isValidElementType,Wo.isAsyncMode,Wo.isConcurrentMode,Wo.isContextConsumer,Wo.isContextProvider,Wo.isElement,Wo.isForwardRef,Wo.isFragment,Wo.isLazy,Wo.isMemo,Wo.isPortal,Wo.isProfiler,Wo.isStrictMode,Wo.isSuspense,Ko(function(e){e.exports=Vo});var Jo=Object.getOwnPropertySymbols,Xo=Object.prototype.hasOwnProperty,Yo=Object.prototype.propertyIsEnumerable;(function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}})()&&Object.assign;var Qo="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";Function.call.bind(Object.prototype.hasOwnProperty);function Zo(){}function ei(){}ei.resetWarningCache=Zo;var ti=Ko(function(e){e.exports=function(){function e(e,t,n,r,o,i){if(i!==Qo){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:ei,resetWarningCache:Zo};return n.PropTypes=n,n}()});var ni=function(){function e(){r(this,e),this.games=new Map}return i(e,[{key:"connect",value:function(){}},{key:"set",value:function(e,t){return this.games.set(e,t)}},{key:"get",value:function(e){return this.games.get(e)}},{key:"has",value:function(e){return this.games.has(e)}},{key:"remove",value:function(e){this.games.has(e)&&this.games.delete(e)}},{key:"list",value:function(){return h(this.games.keys())}}]),e}(),ri=function(e){return"".concat(e,":metadata")},oi=function(e,t){if(e&&e.players)return e.players[t]};function ii(e,t){return void 0===e?e:e.map(function(e){if(null!==t&&+t==+e.action.payload.playerID)return e;if(!0!==e.redact)return e;var n=c({},e.action.payload,{args:null}),r=c({},e,{action:c({},e.action,{payload:n})});r.redact;return f(r,["redact"])})}var ai=function(e){if(!e)return!1;var t=e.players;return Object.keys(t).some(function(e){return!(!t[e]||!t[e].credentials)})},si=function(e,t){return!!e&&(!!t&&e===t.credentials)},ci=function(){function e(t,n,o,i){r(this,e),this.game=Ze(t),this.storageAPI=n,this.transportAPI=o,this.auth=null,this.subscribeCallback=function(){},this.shouldAuth=function(){return!1},!0===i?(this.auth=si,this.shouldAuth=ai):"function"==typeof i&&(this.auth=i,this.shouldAuth=function(){return!0})}return i(e,[{key:"subscribe",value:function(e){this.subscribeCallback=e}},{key:"onUpdate",value:async function(e,t,n,r){var o,i=this,a=(e.payload||{}).credentials;if(this.executeSynchronously){var s=this.storageAPI.get(ri(n)),l=oi(s,r);o=!this.shouldAuth(s)||this.auth(a,l)}else{var u=await this.storageAPI.get(ri(n)),p=oi(u,r);o=!this.shouldAuth(u)||await this.auth(a,p)}if(!o)return{error:"unauthorized action"};var f,d=n;if(void 0===(f=this.executeSynchronously?this.storageAPI.get(d):await this.storageAPI.get(d)))return Re("game not found, gameID=[".concat(d,"]")),{error:"game not found"};if(void 0===f.ctx.gameover){var y=g(vo({game:this.game,numPlayers:f.ctx.numPlayers}),f);if(e.type!=E&&e.type!=D||f.ctx.currentPlayer===r&&null===f.ctx.activePlayers)if(this.game.flow.isPlayerActive(f.G,f.ctx,r))if(e.type!=O||this.game.flow.getMove(f.ctx,e.payload.type,r))if(f._stateID===t){var v=y.getState().log||[];y.dispatch(e),f=y.getState(),this.subscribeCallback({state:f,action:e,gameID:n}),this.transportAPI.sendAll(function(e){var t=c({},f,{G:i.game.playerView(f.G,f.ctx,e),ctx:c({},f.ctx,{_random:void 0}),log:void 0,deltalog:void 0,_undo:[],_redo:[],_initial:c({},f._initial,{_undo:[],_redo:[]})}),r=ii(f.deltalog,e);return{type:"update",args:[n,t,r]}}),v=[].concat(h(v),h(f.deltalog));var m=c({},f,{log:v});this.executeSynchronously?this.storageAPI.set(d,m):await this.storageAPI.set(d,m)}else Re("invalid stateID, was=[".concat(t,"], expected=[").concat(f._stateID,"]"));else Re("move not processed - canPlayerMakeMove=false, playerID=[".concat(r,"]"));else Re("player not active - playerID=[".concat(r,"]"));else Re("playerID=[".concat(r,"] cannot undo / redo right now"))}else Re("game over - gameID=[".concat(d,"]"))}},{key:"onSync",value:async function(e,t,n){var r,o,i,a=e;this.executeSynchronously?(r=this.storageAPI.get(a),o=this.storageAPI.get(ri(e))):(r=await this.storageAPI.get(a),o=await this.storageAPI.get(ri(e))),o&&(i=Object.values(o.players).map(function(e){return{id:e.id,name:e.name}})),void 0===r&&(r=Ro({game:this.game,numPlayers:n}),this.subscribeCallback({state:r,gameID:e}),this.executeSynchronously?(this.storageAPI.set(a,r),r=this.storageAPI.get(a)):(await this.storageAPI.set(a,r),r=await this.storageAPI.get(a)));var s=c({},r,{G:this.game.playerView(r.G,r.ctx,t),ctx:c({},r.ctx,{_random:void 0}),log:void 0,deltalog:void 0,_undo:[],_redo:[],_initial:c({},r._initial,{_undo:[],_redo:[]})}),l=ii(r.log,t);this.transportAPI.send({playerID:t,type:"sync",args:[e,s,l,i]})}}]),e}(),li=function e(t){var n=t.store,o=t.gameName,i=t.playerID,a=t.gameID,s=t.numPlayers;r(this,e),this.store=n,this.gameName=o||"default",this.playerID=i||null,this.gameID="".concat(this.gameName,":").concat(a||"default"),this.numPlayers=s||2};function ui(e){var t=e.game,n=e.bots,r={},o={};if(t&&t.ai&&n)for(var i in n){var a=n[i];o[i]=new a({game:t,enumerate:t.ai.enumerate,seed:t.seed})}var s=function(e){var t=e.type,n=e.playerID,o=e.args,i=r[n];void 0!==i&&i.apply(null,[t].concat(h(o)))},c=new ci(t,new ni,{send:s,sendAll:function(e){for(var t in r){var n=e(t),o=n.type,i=n.args;s({type:o,playerID:t,args:i})}}},!1);return c.executeSynchronously=!0,c.connect=function(e,t,n){r[t]=n},c.subscribe(function(e){var t=e.state,r=e.gameID;if(n){var i=function(e,t){if(void 0!==e.ctx.gameover)return null;if(e.ctx.stage)for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];if(o in e.ctx.stage)return o}else if(e.ctx.currentPlayer in t)return e.ctx.currentPlayer;return null}(t,o);null!==i&&setTimeout(async function(){var e=await o[i].play(t,i);await c.onUpdate(e.action,t._stateID,r,e.action.payload.playerID)},100)}}),c}var pi=function(e){function t(e){var n,o=e.master,i=e.game,a=e.store,s=e.gameID,c=e.playerID,l=e.gameName,p=e.numPlayers;return r(this,t),(n=d(this,u(t).call(this,{store:a,gameName:l,playerID:c,gameID:s,numPlayers:p}))).master=o,n.game=i,n.isConnected=!0,n}return l(t,li),i(t,[{key:"onUpdate",value:async function(e,t,n){var r=this.store.getState();if(e==this.gameID&&t._stateID>=r._stateID){var o=T(t,n);this.store.dispatch(o)}}},{key:"onSync",value:function(e,t,n){if(e==this.gameID){var r=M(t,n);this.store.dispatch(r)}}},{key:"onAction",value:function(e,t){this.master.onUpdate(t,e._stateID,this.gameID,this.playerID)}},{key:"connect",value:function(){var e=this;this.master.connect(this.gameID,this.playerID,function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];"sync"==t&&e.onSync.apply(e,r),"update"==t&&e.onUpdate.apply(e,r)}),this.master.onSync(this.gameID,this.playerID,this.numPlayers)}},{key:"disconnect",value:function(){}},{key:"subscribe",value:function(){}},{key:"subscribeGameMetadata",value:function(e){}},{key:"updateGameID",value:function(e){this.gameID=this.gameName+":"+e;var t=R(null);this.store.dispatch(t),this.connect()}},{key:"updatePlayerID",value:function(e){this.playerID=e;var t=R(null);this.store.dispatch(t),this.connect()}}]),t}(),fi=new Map;var di=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,hi=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],yi=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var o=di.exec(e||""),i={},a=14;a--;)i[hi[a]]=o[a]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i},vi=1e3,mi=60*vi,gi=60*mi,bi=24*gi,xi=365.25*bi,wi=function(e,t){t=t||{};var n,r=typeof e;if("string"===r&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return n*xi;case"days":case"day":case"d":return n*bi;case"hours":case"hour":case"hrs":case"hr":case"h":return n*gi;case"minutes":case"minute":case"mins":case"min":case"m":return n*mi;case"seconds":case"second":case"secs":case"sec":case"s":return n*vi;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}(e);if("number"===r&&!1===isNaN(e))return t.long?ki(n=e,bi,"day")||ki(n,gi,"hour")||ki(n,mi,"minute")||ki(n,vi,"second")||n+" ms":function(e){if(e>=bi)return Math.round(e/bi)+"d";if(e>=gi)return Math.round(e/gi)+"h";if(e>=mi)return Math.round(e/mi)+"m";if(e>=vi)return Math.round(e/vi)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function ki(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var $i=Ko(function(e,t){function n(e){var n;function o(){if(o.enabled){var e=o,r=+new Date,i=r-(n||r);e.diff=i,e.prev=n,e.curr=r,n=r;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=a[c];n=o.call(e,i),a.splice(c,1),c--}return n}),t.formatArgs.call(e,a),(o.log||t.log||console.log.bind(console)).apply(e,a)}}return o.namespace=e,o.enabled=t.enabled(e),o.useColors=t.useColors(),o.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),o.destroy=r,"function"==typeof t.init&&t.init(o),t.instances.push(o),o}function r(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var i=t.instances[n];i.enabled=t.enabled(i.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=wi,t.instances=[],t.names=[],t.skips=[],t.formatters={}}),Pi=($i.coerce,$i.disable,$i.enable,$i.enabled,$i.humanize,$i.instances,$i.names,$i.skips,$i.formatters,Ko(function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=$i).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(n())})),Ci=(Pi.log,Pi.formatArgs,Pi.save,Pi.load,Pi.useColors,Pi.storage,Pi.colors,Pi("socket.io-client:url")),Oi=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host);"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(Ci("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),Ci("parse %s",e),n=yi(e));n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443"));n.path=n.path||"/";var r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port,n.href=n.protocol+"://"+r+(t&&t.port===n.port?"":":"+n.port),n};var Ii=Ko(function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}}),Di={}.toString,Ai=Array.isArray||function(e){return"[object Array]"==Di.call(e)},_i=function(e){return Ei&&Buffer.isBuffer(e)||Si&&(e instanceof ArrayBuffer||ji(e))},Ei="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,Si="function"==typeof ArrayBuffer,ji=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer};var Bi=Object.prototype.toString,Ni="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Bi.call(Blob),Mi="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Bi.call(File);var Ti={deconstructPacket:function(e){var t=[],n=e.data,r=e;return r.data=function e(t,n){if(!t)return t;if(_i(t)){var r={_placeholder:!0,num:n.length};return n.push(t),r}if(Ai(t)){for(var o=new Array(t.length),i=0;i<t.length;i++)o[i]=e(t[i],n);return o}if("object"==typeof t&&!(t instanceof Date)){var o={};for(var a in t)o[a]=e(t[a],n);return o}return t}(n,t),r.attachments=t.length,{packet:r,buffers:t}},reconstructPacket:function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(Ai(t))for(var r=0;r<t.length;r++)t[r]=e(t[r],n);else if("object"==typeof t)for(var o in t)t[o]=e(t[o],n);return t}(e.data,t),e.attachments=void 0,e},removeBlobs:function(e,t){var n=0,r=e;!function e(o,i,a){if(!o)return o;if(Ni&&o instanceof Blob||Mi&&o instanceof File){n++;var s=new FileReader;s.onload=function(){a?a[i]=this.result:r=this.result,--n||t(r)},s.readAsArrayBuffer(o)}else if(Ai(o))for(var c=0;c<o.length;c++)e(o[c],c,o);else if("object"==typeof o&&!_i(o))for(var l in o)e(o[l],l,o)}(r),n||t(r)}},Ri=Ko(function(e,t){var n=Pi("socket.io-parser");function r(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=r,t.Decoder=a;var o=t.ERROR+'"encode error"';function i(e){var r=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(r+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(r+=e.nsp+","),null!=e.id&&(r+=e.id),null!=e.data){var i=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===i)return o;r+=i}return n("encoded %j as %s",e,r),r}function a(){this.reconstructor=null}function s(e){this.reconPack=e,this.buffers=[]}function c(e){return{type:t.ERROR,data:"parser error: "+e}}r.prototype.encode=function(e,r){(n("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type)?function(e,t){Ti.removeBlobs(e,function(e){var n=Ti.deconstructPacket(e),r=i(n.packet),o=n.buffers;o.unshift(r),t(o)})}(e,r):r([i(e)])},Ii(a.prototype),a.prototype.add=function(e){var r;if("string"==typeof e)r=function(e){var r=0,o={type:Number(e.charAt(0))};if(null==t.types[o.type])return c("unknown packet type "+o.type);if(t.BINARY_EVENT===o.type||t.BINARY_ACK===o.type){for(var i="";"-"!==e.charAt(++r)&&(i+=e.charAt(r),r!=e.length););if(i!=Number(i)||"-"!==e.charAt(r))throw new Error("Illegal attachments");o.attachments=Number(i)}if("/"===e.charAt(r+1))for(o.nsp="";++r;){var a=e.charAt(r);if(","===a)break;if(o.nsp+=a,r===e.length)break}else o.nsp="/";var s=e.charAt(r+1);if(""!==s&&Number(s)==s){for(o.id="";++r;){var a=e.charAt(r);if(null==a||Number(a)!=a){--r;break}if(o.id+=e.charAt(r),r===e.length)break}o.id=Number(o.id)}if(e.charAt(++r)){var l=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(r)),u=!1!==l&&(o.type===t.ERROR||Ai(l));if(!u)return c("invalid payload");o.data=l}return n("decoded %s as %j",e,o),o}(e),t.BINARY_EVENT===r.type||t.BINARY_ACK===r.type?(this.reconstructor=new s(r),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",r)):this.emit("decoded",r);else{if(!_i(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(r=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",r))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},s.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=Ti.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},s.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}}),qi=(Ri.protocol,Ri.types,Ri.CONNECT,Ri.DISCONNECT,Ri.EVENT,Ri.ACK,Ri.ERROR,Ri.BINARY_EVENT,Ri.BINARY_ACK,Ri.Encoder,Ri.Decoder,Ko(function(e){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}})),Li=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||qi))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}},zi=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t},Fi={}.toString,Ui=Array.isArray||function(e){return"[object Array]"==Fi.call(e)},Gi=Object.prototype.toString,Hi="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Gi.call(Blob),Ki="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===Gi.call(File),Vi=function e(t){if(!t||"object"!=typeof t)return!1;if(Ui(t)){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||Hi&&t instanceof Blob||Ki&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&e(t[o]))return!0;return!1};var Wi=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)i[s]=o[a];return i.buffer},Ji=function(e,t,n){var r=!1;return n=n||Xi,o.count=e,0===e?t():o;function o(e,i){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(r=!0,t(e),t=n):0!==o.count||r||t(null,i)}};function Xi(){}var Yi,Qi,Zi,ea=String.fromCharCode;function ta(e){for(var t,n,r=[],o=0,i=e.length;o<i;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function na(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function ra(e,t){return ea(e>>t&63|128)}function oa(e,t){if(0==(4294967168&e))return ea(e);var n="";return 0==(4294965248&e)?n=ea(e>>6&31|192):0==(4294901760&e)?(na(e,t)||(e=65533),n=ea(e>>12&15|224),n+=ra(e,6)):0==(4292870144&e)&&(n=ea(e>>18&7|240),n+=ra(e,12),n+=ra(e,6)),n+=ea(63&e|128)}function ia(){if(Zi>=Qi)throw Error("Invalid byte index");var e=255&Yi[Zi];if(Zi++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function aa(e){var t,n;if(Zi>Qi)throw Error("Invalid byte index");if(Zi==Qi)return!1;if(t=255&Yi[Zi],Zi++,0==(128&t))return t;if(192==(224&t)){if((n=(31&t)<<6|ia())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if((n=(15&t)<<12|ia()<<6|ia())>=2048)return na(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(n=(7&t)<<18|ia()<<12|ia()<<6|ia())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}var sa={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=ta(e),o=r.length,i=-1,a="";++i<o;)a+=oa(r[i],n);return a},decode:function(e,t){var n=!1!==(t=t||{}).strict;Yi=ta(e),Qi=Yi.length,Zi=0;for(var r,o=[];!1!==(r=aa(n));)o.push(r);return function(e){for(var t,n=e.length,r=-1,o="";++r<n;)(t=e[r])>65535&&(o+=ea((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=ea(t);return o}(o)}},ca=Ko(function(e,t){!function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),o=r.length,i="";for(n=0;n<o;n+=3)i+=e[r[n]>>2],i+=e[(3&r[n])<<4|r[n+1]>>4],i+=e[(15&r[n+1])<<2|r[n+2]>>6],i+=e[63&r[n+2]];return o%3==2?i=i.substring(0,i.length-1)+"=":o%3==1&&(i=i.substring(0,i.length-2)+"=="),i},t.decode=function(e){var t,r,o,i,a,s=.75*e.length,c=e.length,l=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var u=new ArrayBuffer(s),p=new Uint8Array(u);for(t=0;t<c;t+=4)r=n[e.charCodeAt(t)],o=n[e.charCodeAt(t+1)],i=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],p[l++]=r<<2|o>>4,p[l++]=(15&o)<<4|i>>2,p[l++]=(3&i)<<6|63&a;return u}}()}),la=(ca.encode,ca.decode,void 0!==la?la:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder),ua=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),pa=ua&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),fa=la&&la.prototype.append&&la.prototype.getBlob;function da(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e})}function ha(e,t){t=t||{};var n=new la;return da(e).forEach(function(e){n.append(e)}),t.type?n.getBlob(t.type):n.getBlob()}function ya(e,t){return new Blob(da(e),t||{})}"undefined"!=typeof Blob&&(ha.prototype=Blob.prototype,ya.prototype=Blob.prototype);var va=ua?pa?Blob:ya:fa?ha:void 0,ma=Ko(function(e,t){var n;"undefined"!=typeof ArrayBuffer&&(n=ca);var r="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),o="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),i=r||o;t.protocol=3;var a=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},s=zi(a),c={type:"error",data:"parser error"};function l(e,t,n){for(var r=new Array(e.length),o=Ji(e.length,n),i=function(e,n,o){t(n,function(t,n){r[e]=n,o(t,r)})},a=0;a<e.length;a++)i(a,e[a],o)}t.encodePacket=function(e,n,r,o){"function"==typeof n&&(o=n,n=!1),"function"==typeof r&&(o=r,r=null);var s=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&s instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=e.data,i=new Uint8Array(o),s=new Uint8Array(1+o.byteLength);s[0]=a[e.type];for(var c=0;c<i.length;c++)s[c+1]=i[c];return r(s.buffer)}(e,n,o);if(void 0!==va&&s instanceof va)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(i)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var o=new FileReader;return o.onload=function(){t.encodePacket({type:e.type,data:o.result},n,!0,r)},o.readAsArrayBuffer(e.data)}(e,n,r);var o=new Uint8Array(1);o[0]=a[e.type];var s=new va([o.buffer,e.data]);return r(s)}(e,n,o);if(s&&s.base64)return function(e,n){var r="b"+t.packets[e.type]+e.data.data;return n(r)}(e,o);var c=a[e.type];return void 0!==e.data&&(c+=r?sa.encode(String(e.data),{strict:!1}):String(e.data)),o(""+c)},t.encodeBase64Packet=function(e,n){var r,o="b"+t.packets[e.type];if(void 0!==va&&e.data instanceof va){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];n(o+e)},i.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a[c];r=String.fromCharCode.apply(null,s)}return o+=btoa(r),n(o)},t.decodePacket=function(e,n,r){if(void 0===e)return c;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=sa.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return c;var o=e.charAt(0);return Number(o)==o&&s[o]?e.length>1?{type:s[o],data:e.substring(1)}:{type:s[o]}:c}o=new Uint8Array(e)[0];var i=Wi(e,1);return va&&"blob"===n&&(i=new va([i])),{type:s[o],data:i}},t.decodeBase64Packet=function(e,t){var r=s[e.charAt(0)];if(!n)return{type:r,data:{base64:!0,data:e.substr(1)}};var o=n.decode(e.substr(1));return"blob"===t&&va&&(o=new va([o])),{type:r,data:o}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var o=Vi(e);if(n&&o)return va&&!i?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r);if(!e.length)return r("0:");l(e,function(e,r){t.encodePacket(e,!!o&&n,!1,function(e){r(null,function(e){return e.length+":"+e}(e))})},function(e,t){return r(t.join(""))})},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var o;if("function"==typeof n&&(r=n,n=null),""===e)return r(c,0,1);for(var i,a,s="",l=0,u=e.length;l<u;l++){var p=e.charAt(l);if(":"===p){if(""===s||s!=(i=Number(s)))return r(c,0,1);if(s!=(a=e.substr(l+1,i)).length)return r(c,0,1);if(a.length){if(o=t.decodePacket(a,n,!1),c.type===o.type&&c.data===o.data)return r(c,0,1);if(!1===r(o,l+i,u))return}l+=i,s=""}else s+=p}return""!==s?r(c,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));l(e,function(e,n){t.encodePacket(e,!0,!0,function(e){return n(null,e)})},function(e,t){var r=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),o=new Uint8Array(r),i=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}o[i++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)o[i++]=parseInt(s[a]);o[i++]=255;for(r=new Uint8Array(n),a=0;a<r.length;a++)o[i++]=r[a]}),n(o.buffer)})},t.encodePayloadAsBlob=function(e,n){l(e,function(e,n){t.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);e=r.buffer,t[0]=0}var i=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(i.length+1);for(o=0;o<i.length;o++)a[o]=parseInt(i[o]);if(a[i.length]=255,va){var s=new va([t.buffer,a.buffer,e]);n(null,s)}})},function(e,t){return n(new va(t))})},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var o=e,i=[];o.byteLength>0;){for(var a=new Uint8Array(o),s=0===a[0],l="",u=1;255!==a[u];u++){if(l.length>310)return r(c,0,1);l+=a[u]}o=Wi(o,2+l.length),l=parseInt(l);var p=Wi(o,0,l);if(s)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(e){var f=new Uint8Array(p);p="";for(u=0;u<f.length;u++)p+=String.fromCharCode(f[u])}i.push(p),o=Wi(o,l)}var d=i.length;i.forEach(function(e,o){r(t.decodePacket(e,n,!0),o,d)})}}),ga=(ma.protocol,ma.packets,ma.encodePacket,ma.encodeBase64Packet,ma.decodePacket,ma.decodeBase64Packet,ma.encodePayload,ma.decodePayload,ma.encodePayloadAsArrayBuffer,ma.encodePayloadAsBlob,ma.decodePayloadAsBinary,ba);function ba(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}Ii(ba.prototype),ba.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},ba.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},ba.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},ba.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},ba.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},ba.prototype.onData=function(e){var t=ma.decodePacket(e,this.socket.binaryType);this.onPacket(t)},ba.prototype.onPacket=function(e){this.emit("packet",e)},ba.prototype.onClose=function(){this.readyState="closed",this.emit("close")};var xa,wa={encode:function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},decode:function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},ka=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},$a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),Pa=64,Ca={},Oa=0,Ia=0;function Da(e){var t="";do{t=$a[e%Pa]+t,e=Math.floor(e/Pa)}while(e>0);return t}function Aa(){var e=Da(+new Date);return e!==xa?(Oa=0,xa=e):e+"."+Da(Oa++)}for(;Ia<Pa;Ia++)Ca[$a[Ia]]=Ia;Aa.encode=Da,Aa.decode=function(e){var t=0;for(Ia=0;Ia<e.length;Ia++)t=t*Pa+Ca[e.charAt(Ia)];return t};var _a=Aa,Ea=Pi("engine.io-client:polling"),Sa=Ba,ja=null!=new Li({xdomain:!1}).responseType;function Ba(e){var t=e&&e.forceBase64;ja&&!t||(this.supportsBinary=!1),ga.call(this,e)}ka(Ba,ga),Ba.prototype.name="polling",Ba.prototype.doOpen=function(){this.poll()},Ba.prototype.pause=function(e){var t=this;function n(){Ea("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(Ea("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){Ea("pre-pause polling complete"),--r||n()})),this.writable||(Ea("we are currently writing - waiting to pause"),r++,this.once("drain",function(){Ea("pre-pause writing complete"),--r||n()}))}else n()},Ba.prototype.poll=function(){Ea("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},Ba.prototype.onData=function(e){var t=this;Ea("polling got data %s",e);ma.decodePayload(e,this.socket.binaryType,function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():Ea('ignoring poll - transport state "%s"',this.readyState))},Ba.prototype.doClose=function(){var e=this;function t(){Ea("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(Ea("transport open - closing"),t()):(Ea("transport not open - deferring close"),this.once("open",t))},Ba.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};ma.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},Ba.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=_a()),this.supportsBinary||e.sid||(e.b64=1),e=wa.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e};var Na=Pi("engine.io-client:polling-xhr"),Ma=qa,Ta=La;function Ra(){}function qa(e){if(Sa.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function La(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(ka(qa,Sa),qa.prototype.supportsBinary=!0,qa.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new La(e)},qa.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=r},qa.prototype.doPoll=function(){Na("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},Ii(La.prototype),La.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new Li(e),n=this;try{Na("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=!0),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");n.supportsBinary&&"application/octet-stream"===e&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError(t.status)},0))},Na("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!=typeof document&&(this.index=La.requestsCount++,La.requests[this.index]=this)},La.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},La.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},La.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},La.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=Ra:this.xhr.onreadystatechange=Ra,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete La.requests[this.index],this.xhr=null}},La.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e="application/octet-stream"===t&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},La.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},La.prototype.abort=function(){this.cleanup()},La.requestsCount=0,La.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",Fa);else if("function"==typeof addEventListener){var za="onpagehide"in self?"pagehide":"unload";addEventListener(za,Fa,!1)}function Fa(){for(var e in La.requests)La.requests.hasOwnProperty(e)&&La.requests[e].abort()}Ma.Request=Ta;var Ua,Ga=Ja,Ha=/\n/g,Ka=/\\n/g;function Va(){}function Wa(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==Go?Go:{}}function Ja(e){if(Sa.call(this,e),this.query=this.query||{},!Ua){var t=Wa();Ua=t.___eio=t.___eio||[]}this.index=Ua.length;var n=this;Ua.push(function(e){n.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){n.script&&(n.script.onerror=Va)},!1)}ka(Ja,Sa),Ja.prototype.supportsBinary=!1,Ja.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),Sa.prototype.doClose.call(this)},Ja.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},Ja.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),i=document.createElement("textarea"),a=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=a,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}function s(){c(),t()}function c(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),c(),e=e.replace(Ka,"\\\n"),this.area.value=e.replace(Ha,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&s()}:this.iframe.onload=s};var Xa,Ya,Qa=Pi("engine.io-client:websocket");if("undefined"!=typeof WebSocket)Xa=WebSocket;else if("undefined"!=typeof self)Xa=self.WebSocket||self.MozWebSocket;else try{Ya={}}catch(e){}var Za=Xa||Ya,es=ts;function ts(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=Xa&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(Za=Ya),ga.call(this,e)}ka(ts,ga),ts.prototype.name="websocket",ts.prototype.supportsBinary=!0,ts.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new Za(e,t):new Za(e):new Za(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},ts.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},ts.prototype.write=function(e){var t=this;this.writable=!1;for(var n=e.length,r=0,o=n;r<o;r++)!function(e){ma.encodePacket(e,t.supportsBinary,function(r){if(!t.usingBrowserWebSocket){var o={};if(e.options&&(o.compress=e.options.compress),t.perMessageDeflate)("string"==typeof r?Buffer.byteLength(r):r.length)<t.perMessageDeflate.threshold&&(o.compress=!1)}try{t.usingBrowserWebSocket?t.ws.send(r):t.ws.send(r,o)}catch(e){Qa("websocket closed before onclose event")}--n||i()})}(e[r]);function i(){t.emit("flush"),setTimeout(function(){t.writable=!0,t.emit("drain")},0)}},ts.prototype.onClose=function(){ga.prototype.onClose.call(this)},ts.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},ts.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=_a()),this.supportsBinary||(e.b64=1),(e=wa.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},ts.prototype.check=function(){return!(!Za||"__initialize"in Za&&this.name===ts.prototype.name)};var ns={polling:function(e){var t=!1,n=!1,r=!1!==e.jsonp;if("undefined"!=typeof location){var o="https:"===location.protocol,i=location.port;i||(i=o?443:80),t=e.hostname!==location.hostname||i!==e.port,n=e.secure!==o}if(e.xdomain=t,e.xscheme=n,"open"in new Li(e)&&!e.forceJSONP)return new Ma(e);if(!r)throw new Error("JSONP disabled");return new Ga(e)},websocket:es},rs=[].indexOf,os=function(e,t){if(rs)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1},is=Pi("engine.io-client:socket"),as=ss;function ss(e,t){if(!(this instanceof ss))return new ss(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=yi(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=yi(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=wa.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}ss.priorWebsocketSuccess=!1,Ii(ss.prototype),ss.protocol=ma.protocol,ss.Socket=ss,ss.Transport=ga,ss.transports=ns,ss.parser=ma,ss.prototype.createTransport=function(e){is('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=ma.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new ns[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},ss.prototype.open=function(){var e;if(this.rememberUpgrade&&ss.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},ss.prototype.setTransport=function(e){is("setting transport %s",e.name);var t=this;this.transport&&(is("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},ss.prototype.probe=function(e){is('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function o(){if(r.onlyBinaryUpgrades){var o=!this.supportsBinary&&r.transport.supportsBinary;n=n||o}n||(is('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(o){if(!n)if("pong"===o.type&&"probe"===o.data){if(is('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;ss.priorWebsocketSuccess="websocket"===t.name,is('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){n||"closed"!==r.readyState&&(is("changing transport and sending upgrade packet"),u(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())})}else{is('probe transport "%s" failed',e);var i=new Error("probe error");i.transport=t.name,r.emit("upgradeError",i)}}))}function i(){n||(n=!0,u(),t.close(),t=null)}function a(n){var o=new Error("probe error: "+n);o.transport=t.name,i(),is('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",o)}function s(){a("transport closed")}function c(){a("socket closed")}function l(e){t&&e.name!==t.name&&(is('"%s" works - aborting "%s"',e.name,t.name),i())}function u(){t.removeListener("open",o),t.removeListener("error",a),t.removeListener("close",s),r.removeListener("close",c),r.removeListener("upgrading",l)}ss.priorWebsocketSuccess=!1,t.once("open",o),t.once("error",a),t.once("close",s),this.once("close",c),this.once("upgrading",l),t.open()},ss.prototype.onOpen=function(){if(is("socket open"),this.readyState="open",ss.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){is("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},ss.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(is('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else is('packet received with socket readyState "%s"',this.readyState)},ss.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},ss.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},ss.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){is("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},ss.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},ss.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},ss.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(is("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},ss.prototype.write=ss.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},ss.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},ss.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}function t(){e.onClose("forced close"),is("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},ss.prototype.onError=function(e){is("socket error %j",e),ss.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},ss.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){is('socket close with reason: "%s"',e);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0}},ss.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~os(this.transports,e[n])&&t.push(e[n]);return t};var cs=as,ls=ma;cs.parser=ls;var us=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n};var ps=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}};var fs=[].slice,ds=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=fs.call(arguments,2);return function(){return t.apply(e,n.concat(fs.call(arguments)))}},hs=Ko(function(e,t){var n=Pi("socket.io-client:socket");e.exports=i;var r={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},o=Ii.prototype.emit;function i(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}Ii(i.prototype),i.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[ps(e,"open",ds(this,"onopen")),ps(e,"packet",ds(this,"onpacket")),ps(e,"close",ds(this,"onclose"))]}},i.prototype.open=i.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},i.prototype.send=function(){var e=us(arguments);return e.unshift("message"),this.emit.apply(this,e),this},i.prototype.emit=function(e){if(r.hasOwnProperty(e))return o.apply(this,arguments),this;var t=us(arguments),i={type:(void 0!==this.flags.binary?this.flags.binary:Vi(t))?Ri.BINARY_EVENT:Ri.EVENT,data:t,options:{}};return i.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(n("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),this.flags={},this},i.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},i.prototype.onopen=function(){if(n("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?wa.encode(this.query):this.query;n("sending connect packet with query %s",e),this.packet({type:Ri.CONNECT,query:e})}else this.packet({type:Ri.CONNECT})},i.prototype.onclose=function(e){n("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},i.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===Ri.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case Ri.CONNECT:this.onconnect();break;case Ri.EVENT:case Ri.BINARY_EVENT:this.onevent(e);break;case Ri.ACK:case Ri.BINARY_ACK:this.onack(e);break;case Ri.DISCONNECT:this.ondisconnect();break;case Ri.ERROR:this.emit("error",e.data)}},i.prototype.onevent=function(e){var t=e.data||[];n("emitting event %j",t),null!=e.id&&(n("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?o.apply(this,t):this.receiveBuffer.push(t)},i.prototype.ack=function(e){var t=this,r=!1;return function(){if(!r){r=!0;var o=us(arguments);n("sending ack %j",o),t.packet({type:Vi(o)?Ri.BINARY_ACK:Ri.ACK,id:e,data:o})}}},i.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(n("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):n("bad ack %s",e.id)},i.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},i.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)o.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},i.prototype.ondisconnect=function(){n("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},i.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},i.prototype.close=i.prototype.disconnect=function(){return this.connected&&(n("performing disconnect (%s)",this.nsp),this.packet({type:Ri.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},i.prototype.compress=function(e){return this.flags.compress=e,this},i.prototype.binary=function(e){return this.flags.binary=e,this}}),ys=vs;function vs(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}vs.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},vs.prototype.reset=function(){this.attempts=0},vs.prototype.setMin=function(e){this.ms=e},vs.prototype.setMax=function(e){this.max=e},vs.prototype.setJitter=function(e){this.jitter=e};var ms=Pi("socket.io-client:manager"),gs=Object.prototype.hasOwnProperty,bs=xs;function xs(e,t){if(!(this instanceof xs))return new xs(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new ys({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||Ri;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}xs.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)gs.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},xs.prototype.updateSocketIds=function(){for(var e in this.nsps)gs.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},xs.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},Ii(xs.prototype),xs.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},xs.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},xs.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},xs.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},xs.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},xs.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},xs.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},xs.prototype.open=xs.prototype.connect=function(e,t){if(ms("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;ms("opening %s",this.uri),this.engine=cs(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=ps(n,"open",function(){r.onopen(),e&&e()}),i=ps(n,"error",function(t){if(ms("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;ms("connect attempt will timeout after %d",a);var s=setTimeout(function(){ms("connect attempt timed out after %d",a),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(o),this.subs.push(i),this},xs.prototype.onopen=function(){ms("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(ps(e,"data",ds(this,"ondata"))),this.subs.push(ps(e,"ping",ds(this,"onping"))),this.subs.push(ps(e,"pong",ds(this,"onpong"))),this.subs.push(ps(e,"error",ds(this,"onerror"))),this.subs.push(ps(e,"close",ds(this,"onclose"))),this.subs.push(ps(this.decoder,"decoded",ds(this,"ondecoded")))},xs.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},xs.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},xs.prototype.ondata=function(e){this.decoder.add(e)},xs.prototype.ondecoded=function(e){this.emit("packet",e)},xs.prototype.onerror=function(e){ms("error",e),this.emitAll("error",e)},xs.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new hs(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",o),n.on("connect",function(){n.id=r.generateId(e)}),this.autoConnect&&o()}function o(){~os(r.connecting,n)||r.connecting.push(n)}return n},xs.prototype.destroy=function(e){var t=os(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},xs.prototype.packet=function(e){ms("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()}))},xs.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},xs.prototype.cleanup=function(){ms("cleanup");for(var e=this.subs.length,t=0;t<e;t++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},xs.prototype.close=xs.prototype.disconnect=function(){ms("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},xs.prototype.onclose=function(e){ms("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},xs.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)ms("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();ms("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(ms("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(ms("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(ms("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},xs.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)};var ws=Ko(function(e,t){var n=Pi("socket.io-client");e.exports=t=o;var r=t.managers={};function o(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var o,i=Oi(e),a=i.source,s=i.id,c=i.path,l=r[s]&&c in r[s].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||l?(n("ignoring socket cache for %s",a),o=bs(a,t)):(r[s]||(n("new io instance for %s",a),r[s]=bs(a,t)),o=r[s]),i.query&&!t.query&&(t.query=i.query),o.socket(i.path,t)}t.protocol=Ri.protocol,t.connect=o,t.Manager=bs,t.Socket=hs}),ks=(ws.managers,ws.protocol,ws.connect,ws.Manager,ws.Socket,function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.socket,i=n.socketOpts,a=n.store,s=n.gameID,c=n.playerID,l=n.gameName,p=n.numPlayers,f=n.server;return r(this,t),(e=d(this,u(t).call(this,{store:a,gameName:l,playerID:c,gameID:s,numPlayers:p}))).server=f,e.socket=o,e.socketOpts=i,e.isConnected=!1,e.callback=function(){},e.gameMetadataCallback=function(){},e}return l(t,li),i(t,[{key:"onAction",value:function(e,t){this.socket.emit("update",t,e._stateID,this.gameID,this.playerID)}},{key:"connect",value:function(){var e=this;if(!this.socket)if(this.server){var t=this.server;-1==t.search(/^https?:\/\//)&&(t="http://"+this.server),"/"!=t.substr(-1)&&(t+="/"),this.socket=ws(t+this.gameName,this.socketOpts)}else this.socket=ws("/"+this.gameName,this.socketOpts);this.socket.on("update",function(t,n,r){var o=e.store.getState();if(t==e.gameID&&n._stateID>=o._stateID){var i=T(n,r);e.store.dispatch(i)}}),this.socket.on("sync",function(t,n,r,o){if(t==e.gameID){var i=M(n,r);e.gameMetadataCallback(o),e.store.dispatch(i)}}),this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers),this.socket.on("connect",function(){e.isConnected=!0,e.callback()}),this.socket.on("disconnect",function(){e.isConnected=!1,e.callback()})}},{key:"disconnect",value:function(){this.socket.close(),this.socket=null,this.isConnected=!1,this.callback()}},{key:"subscribe",value:function(e){this.callback=e}},{key:"subscribeGameMetadata",value:function(e){this.gameMetadataCallback=e}},{key:"updateGameID",value:function(e){this.gameID=this.gameName+":"+e;var t=R(null);this.store.dispatch(t),this.socket&&this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers)}},{key:"updatePlayerID",value:function(e){this.playerID=e;var t=R(null);this.store.dispatch(t),this.socket&&this.socket.emit("sync",this.gameID,this.playerID,this.numPlayers)}}]),t}());e.Client=Uo,e.Local=function(e){return function(t){var n;return fi.has(t.gameKey)?n=fi.get(t.gameKey):(n=new ui({game:t.game,bots:e&&e.bots}),fi.set(t.gameKey,n)),new pi(c({master:n},t))}},e.MCTSBot=go,e.RandomBot=bo,e.ReactClient=function(e){var n,o,s=e.game,p=e.numPlayers,f=e.loading,h=e.board,y=e.multiplayer,v=e.enhancer,m=e.debug;void 0===f&&(f=function(){return t.createElement("div",{className:"bgio-loading"},"connecting...")});return o=n=function(e){function n(e){var t;return r(this,n),t=d(this,u(n).call(this,e)),void 0===m&&(m=e.debug),t.client=Uo({game:s,debug:m,numPlayers:p,multiplayer:y,gameID:e.gameID,playerID:e.playerID,credentials:e.credentials,enhancer:v}),t}return l(n,t.Component),i(n,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.client.subscribe(function(){return e.forceUpdate()}),this.client.start()}},{key:"componentWillUnmount",value:function(){this.client.stop(),this.unsubscribe()}},{key:"componentDidUpdate",value:function(e){this.props.gameID!=e.gameID&&this.client.updateGameID(this.props.gameID),this.props.playerID!=e.playerID&&this.client.updatePlayerID(this.props.playerID),this.props.credentials!=e.credentials&&this.client.updateCredentials(this.props.credentials)}},{key:"render",value:function(){var e=this.client.getState();if(null===e)return t.createElement(f);var n=null;return h&&(n=t.createElement(h,c({},e,{},this.props,{isMultiplayer:!!y,moves:this.client.moves,events:this.client.events,gameID:this.client.gameID,playerID:this.client.playerID,reset:this.client.reset,undo:this.client.undo,redo:this.client.redo,gameMetadata:this.client.gameMetadata}))),t.createElement("div",{className:"bgio-client"},n)}}]),n}(),a(n,"propTypes",{gameID:ti.string,playerID:ti.string,credentials:ti.string,debug:ti.any}),a(n,"defaultProps",{gameID:"default",playerID:null,credentials:null,debug:!0}),o},e.ReactNativeClient=function(e){var n,o,s=e.game,p=e.numPlayers,h=e.board,y=e.multiplayer,v=e.enhancer;return o=n=function(e){function n(e){var t;return r(this,n),(t=d(this,u(n).call(this,e))).client=Uo({game:s,numPlayers:p,multiplayer:y,gameID:e.gameID,playerID:e.playerID,credentials:e.credentials,debug:!1,enhancer:v}),t}return l(n,t.Component),i(n,[{key:"componentDidMount",value:function(){var e=this;this.unsubscribe=this.client.subscribe(function(){return e.forceUpdate()}),this.client.start()}},{key:"componentWillUnmount",value:function(){this.client.stop(),this.unsubscribe()}},{key:"componentDidUpdate",value:function(e){e.gameID!=this.props.gameID&&this.client.updateGameID(this.props.gameID),e.playerID!=this.props.playerID&&this.client.updatePlayerID(this.props.playerID),e.credentials!=this.props.credentials&&this.client.updateCredentials(this.props.credentials)}},{key:"render",value:function(){var e=null,n=this.client.getState(),r=this.props,o=r.gameID,i=r.playerID,a=f(r,["gameID","playerID"]);return h&&(e=t.createElement(h,c({},n,{},a,{gameID:o,playerID:i,isMultiplayer:!!y,moves:this.client.moves,events:this.client.events,step:this.client.step,reset:this.client.reset,undo:this.client.undo,redo:this.client.redo,gameMetadata:this.client.gameMetadata}))),e}}]),n}(),a(n,"propTypes",{gameID:ti.string,playerID:ti.string,credentials:ti.string}),a(n,"defaultProps",{gameID:"default",playerID:null,credentials:null}),o},e.Simulate=async function(e){var t=e.game,n=e.bots,r=e.state,o=e.depth;void 0===o&&(o=1e4);for(var i=vo({game:t,numPlayers:r.ctx.numPlayers}),a=null,s=0;void 0===r.ctx.gameover&&s<o;){var c=r.ctx.currentPlayer;r.ctx.activePlayers&&(c=Object.keys(r.ctx.activePlayers)[0]);var l=n instanceof mo?n:n[c],u=await l.play(r,c);if(!u.action)break;a=u.metadata,r=i(r,u.action),s++}return{state:r,metadata:a}},e.SocketIO=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.server,n=e.socketOpts;return function(e){return new ks(c({server:t,socketOpts:n},e))}},e.Step=xo,e.TurnOrder=Ue,Object.defineProperty(e,"__esModule",{value:!0})});
